/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 04:45:32 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 04:45:32 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-base-final-1', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_04-45-32_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=1, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 04:45:37 - INFO - filelock -   Lock 140298260785472 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 04:45:37 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 04:45:37 - INFO - filelock -   Lock 140298260785472 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 04:45:37 - INFO - filelock -   Lock 140292553935984 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 04:45:37 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 04:45:37 - INFO - filelock -   Lock 140292553935984 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.45it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.49s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.26it/s]
{'eval_loss': 1.2580689191818237, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}███████████████████████| 4/4 [00:00<00:00, 15.27it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.948062390089035, 'eval_precision': 0.20689655172413793, 'eval_recall': 0.13793103448275862, 'eval_f1': 0.16551724137931034, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.30it/s]
{'eval_loss': 0.5991321206092834, 'eval_precision': 0.2638888888888889, 'eval_recall': 0.21839080459770116, 'eval_f1': 0.2389937106918239, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.59it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.30it/s]
{'eval_loss': 0.4265778586268425, 'eval_precision': 0.36792452830188677, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.40414507772020725, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.28it/s]
{'eval_loss': 0.309334147721529, 'eval_precision': 0.37719298245614036, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.42786069651741293, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2541917599737644, 'eval_precision': 0.5272727272727272, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.5888324873096445, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}9it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.18183592334389687, 'eval_precision': 0.7419354838709677, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7666666666666667, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.1696216817945242, 'eval_precision': 0.7333333333333333, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7457627118644068, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.18548159301280975, 'eval_precision': 0.6836734693877551, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7243243243243244, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.18925939593464136, 'eval_precision': 0.7282608695652174, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7486033519553073, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.18226871080696583, 'eval_precision': 0.6989247311827957, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7222222222222223, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.20028359442949295, 'eval_precision': 0.5904761904761905, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6458333333333334, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.19760148972272873, 'eval_precision': 0.7640449438202247, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7727272727272727, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.18207974173128605, 'eval_precision': 0.7127659574468085, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7403314917127071, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.21622022613883018, 'eval_precision': 0.7446808510638298, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7734806629834253, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.1897273249924183, 'eval_precision': 0.7978723404255319, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8287292817679558, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.1967293219640851, 'eval_precision': 0.6464646464646465, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6881720430107527, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.18413390684872866, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.17718098033219576, 'eval_precision': 0.7717391304347826, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7932960893854749, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.19847777765244246, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.20137006230652332, 'eval_precision': 0.7391304347826086, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7597765363128491, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.15831419359892607, 'eval_precision': 0.8131868131868132, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8314606741573034, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.17729455046355724, 'eval_precision': 0.7934782608695652, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8156424581005586, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.16664407309144735, 'eval_precision': 0.776595744680851, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8066298342541435, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.18743391521275043, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7692307692307692, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.18375517707318068, 'eval_precision': 0.7291666666666666, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7650273224043717, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.17639965610578656, 'eval_precision': 0.7391304347826086, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7597765363128491, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.17631563311442733, 'eval_precision': 0.7553191489361702, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7845303867403314, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.18330613896250725, 'eval_precision': 0.7553191489361702, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7845303867403314, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.17745898757129908, 'eval_precision': 0.7659574468085106, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7955801104972374, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.1778890723362565, 'eval_precision': 0.7319587628865979, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7717391304347826, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.18008282501250505, 'eval_precision': 0.71, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7593582887700535, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}0:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.1856544567272067, 'eval_precision': 0.71, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7593582887700535, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}00:00, 15.16it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.1812633452937007, 'eval_precision': 0.7346938775510204, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7783783783783784, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.1760288355872035, 'eval_precision': 0.7244897959183674, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7675675675675676, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.1752553042024374, 'eval_precision': 0.7578947368421053, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7912087912087912, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.175255392678082, 'eval_precision': 0.7578947368421053, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7912087912087912, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.24s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 04:49:54 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.45it/s]
{'eval_loss': 0.1753862714394927, 'eval_precision': 0.7578947368421053, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7912087912087912, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/14/2021 04:49:54 - INFO - __main__ -   ***** Eval results *****
04/14/2021 04:49:54 - INFO - __main__ -     eval_loss = 0.1753862714394927
04/14/2021 04:49:54 - INFO - __main__ -     eval_precision = 0.7578947368421053
04/14/2021 04:49:54 - INFO - __main__ -     eval_recall = 0.8275862068965517
04/14/2021 04:49:54 - INFO - __main__ -     eval_f1 = 0.7912087912087912
04/14/2021 04:49:54 - INFO - __main__ -     epoch = 60.0
04/14/2021 04:49:54 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 04:49:56 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 04:49:56 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-base-final-2', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_04-49-56_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=2, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 04:50:01 - INFO - filelock -   Lock 140472384088432 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 04:50:01 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 04:50:01 - INFO - filelock -   Lock 140472384088432 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 04:50:01 - INFO - filelock -   Lock 140466744560656 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 04:50:01 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 04:50:01 - INFO - filelock -   Lock 140466744560656 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.44it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:25,  4.50s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 1.562417596578598, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.1798078417778015, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.8420919179916382, 'eval_precision': 0.2054794520547945, 'eval_recall': 0.1724137931034483, 'eval_f1': 0.1875, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}<00:00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.5431896895170212, 'eval_precision': 0.2916666666666667, 'eval_recall': 0.3218390804597701, 'eval_f1': 0.30601092896174864, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.4306703209877014, 'eval_precision': 0.2833333333333333, 'eval_recall': 0.39080459770114945, 'eval_f1': 0.3285024154589372, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.39403682202100754, 'eval_precision': 0.3135593220338983, 'eval_recall': 0.42528735632183906, 'eval_f1': 0.36097560975609755, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.36237576603889465, 'eval_precision': 0.352, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.41509433962264153, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}0:00, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.3171272464096546, 'eval_precision': 0.5048543689320388, 'eval_recall': 0.5977011494252874, 'eval_f1': 0.5473684210526316, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.38645465299487114, 'eval_precision': 0.48672566371681414, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5499999999999999, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2967942878603935, 'eval_precision': 0.6288659793814433, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6630434782608695, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.3379627503454685, 'eval_precision': 0.384, 'eval_recall': 0.5517241379310345, 'eval_f1': 0.4528301886792453, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}<00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.33967670798301697, 'eval_precision': 0.4782608695652174, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5445544554455446, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.31515803560614586, 'eval_precision': 0.49074074074074076, 'eval_recall': 0.6091954022988506, 'eval_f1': 0.5435897435897437, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.43950071930885315, 'eval_precision': 0.6132075471698113, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6735751295336787, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.4362050835043192, 'eval_precision': 0.5588235294117647, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6031746031746031, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.40668174251914024, 'eval_precision': 0.5728155339805825, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6210526315789473, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.38687504455447197, 'eval_precision': 0.6082474226804123, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6413043478260869, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.4173172675073147, 'eval_precision': 0.5327102803738317, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5876288659793815, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.41713348403573036, 'eval_precision': 0.5757575757575758, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6129032258064515, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.5150859951972961, 'eval_precision': 0.5333333333333333, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.5833333333333333, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.40078094601631165, 'eval_precision': 0.6020408163265306, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6378378378378379, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.418822567909956, 'eval_precision': 0.5961538461538461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.649214659685864, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.41319839283823967, 'eval_precision': 0.5445544554455446, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5851063829787234, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.13it/s]
{'eval_loss': 0.3764632120728493, 'eval_precision': 0.5607476635514018, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6185567010309277, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.4710734151303768, 'eval_precision': 0.5092592592592593, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5641025641025642, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.5091842263936996, 'eval_precision': 0.57, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6096256684491977, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}00:00, 15.17it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.4420003406703472, 'eval_precision': 0.5233644859813084, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.5773195876288659, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.41973622515797615, 'eval_precision': 0.5229357798165137, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5816326530612245, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.4309334270656109, 'eval_precision': 0.5576923076923077, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6073298429319371, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.429392721503973, 'eval_precision': 0.5841584158415841, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.627659574468085, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.41113515943288803, 'eval_precision': 0.5673076923076923, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6178010471204188, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.38970568403601646, 'eval_precision': 0.5769230769230769, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6282722513089005, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.3949328847229481, 'eval_precision': 0.5865384615384616, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6387434554973822, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.408829677850008, 'eval_precision': 0.5841584158415841, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.627659574468085, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.4280673936009407, 'eval_precision': 0.58, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6203208556149732, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}00:00, 15.17it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.4446340575814247, 'eval_precision': 0.5784313725490197, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6243386243386243, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.450644887983799, 'eval_precision': 0.5841584158415841, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.627659574468085, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.25s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 04:54:18 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.46it/s]
{'eval_loss': 0.4510512985289097, 'eval_precision': 0.5841584158415841, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.627659574468085, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/14/2021 04:54:18 - INFO - __main__ -   ***** Eval results *****
04/14/2021 04:54:18 - INFO - __main__ -     eval_loss = 0.4510512985289097
04/14/2021 04:54:18 - INFO - __main__ -     eval_precision = 0.5841584158415841
04/14/2021 04:54:18 - INFO - __main__ -     eval_recall = 0.6781609195402298
04/14/2021 04:54:18 - INFO - __main__ -     eval_f1 = 0.627659574468085
04/14/2021 04:54:18 - INFO - __main__ -     epoch = 60.0
04/14/2021 04:54:18 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 04:54:20 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 04:54:20 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-base-final-3', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_04-54-20_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=3, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 04:54:25 - INFO - filelock -   Lock 140643015371072 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 04:54:25 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 04:54:25 - INFO - filelock -   Lock 140643015371072 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 04:54:25 - INFO - filelock -   Lock 140637375847536 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 04:54:25 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 04:54:25 - INFO - filelock -   Lock 140637375847536 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.44it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:25,  4.51s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.3228702545166016, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.8914827257394791, 'eval_precision': 0.1875, 'eval_recall': 0.06896551724137931, 'eval_f1': 0.10084033613445377, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}00:00, 15.16it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.577995628118515, 'eval_precision': 0.19090909090909092, 'eval_recall': 0.2413793103448276, 'eval_f1': 0.2131979695431472, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}0it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.432528480887413, 'eval_precision': 0.3137254901960784, 'eval_recall': 0.367816091954023, 'eval_f1': 0.33862433862433866, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}17it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.33191943913698196, 'eval_precision': 0.3137254901960784, 'eval_recall': 0.367816091954023, 'eval_f1': 0.33862433862433866, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.32038718089461327, 'eval_precision': 0.4019607843137255, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.43386243386243384, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2574773468077183, 'eval_precision': 0.48717948717948717, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5588235294117647, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.24706906452775002, 'eval_precision': 0.6451612903225806, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6666666666666667, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.25800702162086964, 'eval_precision': 0.5544554455445545, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.5957446808510638, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2629705164581537, 'eval_precision': 0.5514018691588785, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6082474226804123, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.26283094473183155, 'eval_precision': 0.5339805825242718, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5789473684210527, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2778926738537848, 'eval_precision': 0.5288461538461539, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5759162303664922, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}8it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.27047881204634905, 'eval_precision': 0.6105263157894737, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6373626373626373, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.2915666960179806, 'eval_precision': 0.5648148148148148, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6256410256410256, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2675224281847477, 'eval_precision': 0.6082474226804123, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6413043478260869, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.24200504459440708, 'eval_precision': 0.6947368421052632, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7252747252747253, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.2719172188080847, 'eval_precision': 0.6989247311827957, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7222222222222223, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.24277985747903585, 'eval_precision': 0.6875, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7213114754098361, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}:00, 15.16it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.28715028800070286, 'eval_precision': 0.64, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6844919786096256, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}<00:00, 15.15it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.29235859122127295, 'eval_precision': 0.6078431372549019, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6560846560846562, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.24643676728010178, 'eval_precision': 0.6732673267326733, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.723404255319149, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.26904558669775724, 'eval_precision': 0.6190476190476191, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6770833333333333, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2694339482113719, 'eval_precision': 0.6213592233009708, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6736842105263158, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.26537239644676447, 'eval_precision': 0.6274509803921569, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6772486772486773, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.28712115809321404, 'eval_precision': 0.6363636363636364, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6774193548387097, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2994567872956395, 'eval_precision': 0.6363636363636364, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6774193548387097, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2754956944845617, 'eval_precision': 0.6274509803921569, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6772486772486773, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.26507936883717775, 'eval_precision': 0.6274509803921569, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6772486772486773, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.27135793771594763, 'eval_precision': 0.6336633663366337, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6808510638297872, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.28193780360743403, 'eval_precision': 0.63, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6737967914438503, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}0:00, 15.15it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.2545692620333284, 'eval_precision': 0.6979166666666666, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7322404371584699, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.25546289840713143, 'eval_precision': 0.6938775510204082, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7351351351351352, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.27434412739239633, 'eval_precision': 0.6176470588235294, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6666666666666667, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.2954822543542832, 'eval_precision': 0.63, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6737967914438503, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}00:00, 15.15it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2996399812400341, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2954522925429046, 'eval_precision': 0.6428571428571429, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6810810810810811, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2934427016880363, 'eval_precision': 0.6597938144329897, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6956521739130436, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.25s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 04:58:42 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.43it/s]
{'eval_loss': 0.2932386272586882, 'eval_precision': 0.6597938144329897, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6956521739130436, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/14/2021 04:58:42 - INFO - __main__ -   ***** Eval results *****
04/14/2021 04:58:42 - INFO - __main__ -     eval_loss = 0.2932386272586882
04/14/2021 04:58:42 - INFO - __main__ -     eval_precision = 0.6597938144329897
04/14/2021 04:58:42 - INFO - __main__ -     eval_recall = 0.735632183908046
04/14/2021 04:58:42 - INFO - __main__ -     eval_f1 = 0.6956521739130436
04/14/2021 04:58:42 - INFO - __main__ -     epoch = 60.0
04/14/2021 04:58:42 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 04:58:44 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 04:58:44 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-base-final-4', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_04-58-44_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=4, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 04:58:48 - INFO - filelock -   Lock 140315319925056 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 04:58:48 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 04:58:48 - INFO - filelock -   Lock 140315319925056 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 04:58:48 - INFO - filelock -   Lock 140309680405616 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 04:58:48 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 04:58:48 - INFO - filelock -   Lock 140309680405616 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.44it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:26,  4.51s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 1.3267201483249664, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}███████████████████████| 4/4 [00:00<00:00, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.9634084701538086, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}██████████████████████| 4/4 [00:00<00:00, 15.17it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.6239826083183289, 'eval_precision': 0.25, 'eval_recall': 0.27586206896551724, 'eval_f1': 0.26229508196721313, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}<00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.4654124975204468, 'eval_precision': 0.26851851851851855, 'eval_recall': 0.3333333333333333, 'eval_f1': 0.29743589743589743, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.3905588537454605, 'eval_precision': 0.3684210526315789, 'eval_recall': 0.40229885057471265, 'eval_f1': 0.3846153846153846, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.307339608669281, 'eval_precision': 0.3793103448275862, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.4334975369458128, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}16it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.29994339495897293, 'eval_precision': 0.6210526315789474, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6483516483516483, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.18387588113546371, 'eval_precision': 0.4778761061946903, 'eval_recall': 0.6206896551724138, 'eval_f1': 0.54, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}<00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.18703164998441935, 'eval_precision': 0.5643564356435643, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6063829787234043, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.20647396706044674, 'eval_precision': 0.61, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6524064171122995, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}<00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.18651356548070908, 'eval_precision': 0.65625, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6885245901639345, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}:00, 15.17it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.21266869362443686, 'eval_precision': 0.5728155339805825, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6210526315789473, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.20367307402193546, 'eval_precision': 0.66, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7058823529411765, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.19899706728756428, 'eval_precision': 0.6363636363636364, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6774193548387097, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2054850235581398, 'eval_precision': 0.5315315315315315, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.5959595959595959, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.16215533949434757, 'eval_precision': 0.6095238095238096, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6666666666666666, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.17068868316709995, 'eval_precision': 0.5961538461538461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.649214659685864, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.16102961264550686, 'eval_precision': 0.6938775510204082, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7351351351351352, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.17353205103427172, 'eval_precision': 0.6363636363636364, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6774193548387097, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.1970964763313532, 'eval_precision': 0.6176470588235294, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6666666666666667, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.1520960722118616, 'eval_precision': 0.6732673267326733, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.723404255319149, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.19315770268440247, 'eval_precision': 0.6836734693877551, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7243243243243244, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2476415690034628, 'eval_precision': 0.6336633663366337, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6808510638297872, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.1969936853274703, 'eval_precision': 0.6336633663366337, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6808510638297872, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.18297182954847813, 'eval_precision': 0.6470588235294118, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6984126984126984, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.19241595827043056, 'eval_precision': 0.6464646464646465, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6881720430107527, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.20855358708649874, 'eval_precision': 0.6565656565656566, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6989247311827956, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.21639234945178032, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.20611579902470112, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7096774193548386, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2030878011137247, 'eval_precision': 0.6470588235294118, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6984126984126984, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.13it/s]
{'eval_loss': 0.20831526815891266, 'eval_precision': 0.625, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6806282722513088, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}:00, 15.12it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.20171383954584599, 'eval_precision': 0.6213592233009708, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6736842105263158, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.20454893447458744, 'eval_precision': 0.6213592233009708, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6736842105263158, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2063174955546856, 'eval_precision': 0.6116504854368932, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6631578947368421, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2062881924211979, 'eval_precision': 0.6274509803921569, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6772486772486773, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.13it/s]
{'eval_loss': 0.20700800977647305, 'eval_precision': 0.6057692307692307, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6596858638743456, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2074432335793972, 'eval_precision': 0.6057692307692307, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6596858638743456, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.25s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 05:03:06 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.43it/s]
{'eval_loss': 0.20746036618947983, 'eval_precision': 0.6057692307692307, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6596858638743456, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/14/2021 05:03:06 - INFO - __main__ -   ***** Eval results *****
04/14/2021 05:03:06 - INFO - __main__ -     eval_loss = 0.20746036618947983
04/14/2021 05:03:06 - INFO - __main__ -     eval_precision = 0.6057692307692307
04/14/2021 05:03:06 - INFO - __main__ -     eval_recall = 0.7241379310344828
04/14/2021 05:03:06 - INFO - __main__ -     eval_f1 = 0.6596858638743456
04/14/2021 05:03:06 - INFO - __main__ -     epoch = 60.0
04/14/2021 05:03:06 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 05:03:08 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 05:03:08 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-base-final-5', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_05-03-08_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=5, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 05:03:13 - INFO - filelock -   Lock 139748566788464 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:03:13 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 05:03:13 - INFO - filelock -   Lock 139748566788464 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:03:13 - INFO - filelock -   Lock 139742658808848 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 05:03:13 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 05:03:13 - INFO - filelock -   Lock 139742658808848 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.44it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:25,  4.51s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.2289315164089203, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.8580316305160522, 'eval_precision': 0.1, 'eval_recall': 0.022988505747126436, 'eval_f1': 0.037383177570093455, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}<00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.589981734752655, 'eval_precision': 0.1487603305785124, 'eval_recall': 0.20689655172413793, 'eval_f1': 0.17307692307692307, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.42768196016550064, 'eval_precision': 0.1103448275862069, 'eval_recall': 0.1839080459770115, 'eval_f1': 0.13793103448275862, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.3217822089791298, 'eval_precision': 0.375, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.4347826086956522, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}0<00:00, 15.17it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.244117122143507, 'eval_precision': 0.6262626262626263, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6666666666666667, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.19828838296234608, 'eval_precision': 0.6530612244897959, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6918918918918919, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.19846367835998535, 'eval_precision': 0.68, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7272727272727274, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}<00:00, 15.15it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.23440571688115597, 'eval_precision': 0.631578947368421, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6593406593406593, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.25616103783249855, 'eval_precision': 0.6847826086956522, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.7039106145251397, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.25456430949270725, 'eval_precision': 0.5643564356435643, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6063829787234043, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.40335519798099995, 'eval_precision': 0.5104166666666666, 'eval_recall': 0.5632183908045977, 'eval_f1': 0.53551912568306, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}0it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.25516171753406525, 'eval_precision': 0.5673076923076923, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6178010471204188, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.25880920654162765, 'eval_precision': 0.5454545454545454, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6091370558375635, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.26699639251455665, 'eval_precision': 0.62, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6631016042780749, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2877188818529248, 'eval_precision': 0.6288659793814433, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6630434782608695, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.30582529958337545, 'eval_precision': 0.6702127659574468, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6961325966850829, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.3055783906020224, 'eval_precision': 0.7, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.711864406779661, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}00<00:00, 15.14it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2828354565426707, 'eval_precision': 0.6421052631578947, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6703296703296704, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.279072443023324, 'eval_precision': 0.6451612903225806, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6666666666666667, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2843382889404893, 'eval_precision': 0.6774193548387096, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.7, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}<00:00, 15.16it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.27577081276103854, 'eval_precision': 0.7142857142857143, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7303370786516854, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.29831048543564975, 'eval_precision': 0.6451612903225806, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6666666666666667, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.29745286342222244, 'eval_precision': 0.6888888888888889, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.7005649717514124, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2889633721206337, 'eval_precision': 0.5841584158415841, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.627659574468085, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2948470744304359, 'eval_precision': 0.6020408163265306, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6378378378378379, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.2964293115073815, 'eval_precision': 0.6559139784946236, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6777777777777778, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2990984980715439, 'eval_precision': 0.6421052631578947, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6703296703296704, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.29877007176401094, 'eval_precision': 0.6888888888888889, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.7005649717514124, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.30225322814658284, 'eval_precision': 0.7078651685393258, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.7159090909090908, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.3005871524801478, 'eval_precision': 0.6966292134831461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.7045454545454545, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.12it/s]
{'eval_loss': 0.2994463975774124, 'eval_precision': 0.6966292134831461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.7045454545454545, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.30614932492608204, 'eval_precision': 0.6813186813186813, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6966292134831461, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.30864194832975045, 'eval_precision': 0.6966292134831461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.7045454545454545, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.31128956540487707, 'eval_precision': 0.6966292134831461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.7045454545454545, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.31245217856485397, 'eval_precision': 0.6888888888888889, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.7005649717514124, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.3123937208438292, 'eval_precision': 0.6888888888888889, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.7005649717514124, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:15<00:00,  4.25s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 05:07:30 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.43it/s]
{'eval_loss': 0.31243342044763267, 'eval_precision': 0.6888888888888889, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.7005649717514124, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/14/2021 05:07:30 - INFO - __main__ -   ***** Eval results *****
04/14/2021 05:07:30 - INFO - __main__ -     eval_loss = 0.31243342044763267
04/14/2021 05:07:30 - INFO - __main__ -     eval_precision = 0.6888888888888889
04/14/2021 05:07:30 - INFO - __main__ -     eval_recall = 0.7126436781609196
04/14/2021 05:07:30 - INFO - __main__ -     eval_f1 = 0.7005649717514124
04/14/2021 05:07:30 - INFO - __main__ -     epoch = 60.0
04/14/2021 05:07:30 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 05:07:32 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 05:07:32 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-base-final-6', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_05-07-32_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=6, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 05:07:36 - INFO - filelock -   Lock 139753690290544 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:07:36 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 05:07:36 - INFO - filelock -   Lock 139753690290544 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:07:36 - INFO - filelock -   Lock 139748050758672 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 05:07:36 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 05:07:36 - INFO - filelock -   Lock 139748050758672 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.44it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:25,  4.50s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.3002758622169495, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.9482542872428894, 'eval_precision': 0.18604651162790697, 'eval_recall': 0.09195402298850575, 'eval_f1': 0.12307692307692308, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.6169144213199615, 'eval_precision': 0.16, 'eval_recall': 0.1839080459770115, 'eval_f1': 0.1711229946524064, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}00<00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.4342725798487663, 'eval_precision': 0.2627118644067797, 'eval_recall': 0.3563218390804598, 'eval_f1': 0.3024390243902439, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}7it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.36806008219718933, 'eval_precision': 0.35106382978723405, 'eval_recall': 0.3793103448275862, 'eval_f1': 0.3646408839779005, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.28689588978886604, 'eval_precision': 0.5188679245283019, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5699481865284974, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}8it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.25718599930405617, 'eval_precision': 0.648936170212766, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6740331491712708, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.22563198301941156, 'eval_precision': 0.5918367346938775, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6270270270270271, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.20911989733576775, 'eval_precision': 0.6236559139784946, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6444444444444445, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.25300478376448154, 'eval_precision': 0.6063829787234043, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6298342541436465, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.22129547409713268, 'eval_precision': 0.5742574257425742, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6170212765957447, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.21538632176816463, 'eval_precision': 0.6122448979591837, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6486486486486487, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.13it/s]
{'eval_loss': 0.22023072373121977, 'eval_precision': 0.648936170212766, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6740331491712708, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.20234334375709295, 'eval_precision': 0.6020408163265306, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6378378378378379, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.26656126230955124, 'eval_precision': 0.53, 'eval_recall': 0.6091954022988506, 'eval_f1': 0.5668449197860963, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.23451128788292408, 'eval_precision': 0.6185567010309279, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6521739130434783, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2242738977074623, 'eval_precision': 0.6213592233009708, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6736842105263158, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2589342724531889, 'eval_precision': 0.5181818181818182, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5786802030456852, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.25637987814843655, 'eval_precision': 0.58, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6203208556149732, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.24574366118758917, 'eval_precision': 0.6060606060606061, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6451612903225807, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2533862926065922, 'eval_precision': 0.6185567010309279, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6521739130434783, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.26187282614409924, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.289113306440413, 'eval_precision': 0.6185567010309279, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6521739130434783, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.29328034073114395, 'eval_precision': 0.5757575757575758, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6129032258064515, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2850518897175789, 'eval_precision': 0.5959595959595959, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6344086021505375, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.26336353830993176, 'eval_precision': 0.6354166666666666, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6666666666666666, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2684230348095298, 'eval_precision': 0.6326530612244898, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6702702702702703, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.26590584218502045, 'eval_precision': 0.6020408163265306, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6378378378378379, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.27074321918189526, 'eval_precision': 0.5742574257425742, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6170212765957447, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2618092317134142, 'eval_precision': 0.6019417475728155, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6526315789473683, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.25015559047460556, 'eval_precision': 0.63, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6737967914438503, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}0:00, 15.22it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.24674428720027208, 'eval_precision': 0.6494845360824743, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6847826086956522, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.24915252113714814, 'eval_precision': 0.6494845360824743, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6847826086956522, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.25657845893874764, 'eval_precision': 0.6530612244897959, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6918918918918919, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2574891410768032, 'eval_precision': 0.6770833333333334, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7103825136612023, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.25171829713508487, 'eval_precision': 0.6736842105263158, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7032967032967034, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.2500489871017635, 'eval_precision': 0.6989247311827957, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7222222222222223, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.25s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 05:11:53 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.44it/s]
{'eval_loss': 0.249984051566571, 'eval_precision': 0.6989247311827957, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7222222222222223, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/14/2021 05:11:54 - INFO - __main__ -   ***** Eval results *****
04/14/2021 05:11:54 - INFO - __main__ -     eval_loss = 0.249984051566571
04/14/2021 05:11:54 - INFO - __main__ -     eval_precision = 0.6989247311827957
04/14/2021 05:11:54 - INFO - __main__ -     eval_recall = 0.7471264367816092
04/14/2021 05:11:54 - INFO - __main__ -     eval_f1 = 0.7222222222222223
04/14/2021 05:11:54 - INFO - __main__ -     epoch = 60.0
04/14/2021 05:11:54 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 05:11:55 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 05:11:55 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-base-final-7', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_05-11-55_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=7, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 05:12:00 - INFO - filelock -   Lock 140553243486576 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:12:00 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 05:12:00 - INFO - filelock -   Lock 140553243486576 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:12:00 - INFO - filelock -   Lock 140547603950608 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 05:12:00 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 05:12:00 - INFO - filelock -   Lock 140547603950608 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.44it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:25,  4.51s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.34417125582695, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.9574374705553055, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}██████████████████████| 4/4 [00:00<00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.6187416017055511, 'eval_precision': 0.19, 'eval_recall': 0.21839080459770116, 'eval_f1': 0.20320855614973266, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}<00:00, 15.15it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.40479297935962677, 'eval_precision': 0.336734693877551, 'eval_recall': 0.3793103448275862, 'eval_f1': 0.3567567567567568, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}6it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.34393705800175667, 'eval_precision': 0.4077669902912621, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.4421052631578948, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.33899426832795143, 'eval_precision': 0.42857142857142855, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.46875000000000006, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.31152935326099396, 'eval_precision': 0.6555555555555556, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6666666666666666, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2723894417285919, 'eval_precision': 0.5851063829787234, 'eval_recall': 0.632183908045977, 'eval_f1': 0.6077348066298343, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}7it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.30813944712281227, 'eval_precision': 0.5, 'eval_recall': 0.5862068965517241, 'eval_f1': 0.5396825396825397, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}0<00:00, 15.13it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2840257687494159, 'eval_precision': 0.5416666666666666, 'eval_recall': 0.5977011494252874, 'eval_f1': 0.5683060109289617, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2723045740276575, 'eval_precision': 0.4666666666666667, 'eval_recall': 0.5632183908045977, 'eval_f1': 0.5104166666666667, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.26029756339266896, 'eval_precision': 0.5757575757575758, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6129032258064515, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.29049810767173767, 'eval_precision': 0.3879310344827586, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.4433497536945813, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.27046551927924156, 'eval_precision': 0.61, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6524064171122995, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}00:00, 15.17it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.3234385084360838, 'eval_precision': 0.5643564356435643, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6063829787234043, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2987508103251457, 'eval_precision': 0.5514018691588785, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6082474226804123, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.13it/s]
{'eval_loss': 0.33171580359339714, 'eval_precision': 0.5048543689320388, 'eval_recall': 0.5977011494252874, 'eval_f1': 0.5473684210526316, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.38218927197158337, 'eval_precision': 0.5145631067961165, 'eval_recall': 0.6091954022988506, 'eval_f1': 0.5578947368421053, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.3499765731394291, 'eval_precision': 0.5918367346938775, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6270270270270271, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.3431422933936119, 'eval_precision': 0.5377358490566038, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5906735751295337, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.12it/s]
{'eval_loss': 0.29475389048457146, 'eval_precision': 0.6082474226804123, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6413043478260869, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.3700244501233101, 'eval_precision': 0.6263736263736264, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6404494382022472, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.26917941961437464, 'eval_precision': 0.631578947368421, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6593406593406593, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.2585573233664036, 'eval_precision': 0.59, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6310160427807486, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}00:00, 15.13it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2854163236916065, 'eval_precision': 0.5959595959595959, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6344086021505375, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.3176723122596741, 'eval_precision': 0.5445544554455446, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5851063829787234, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.3537062853574753, 'eval_precision': 0.48598130841121495, 'eval_recall': 0.5977011494252874, 'eval_f1': 0.5360824742268042, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.36209605634212494, 'eval_precision': 0.49056603773584906, 'eval_recall': 0.5977011494252874, 'eval_f1': 0.538860103626943, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.35361870005726814, 'eval_precision': 0.5242718446601942, 'eval_recall': 0.6206896551724138, 'eval_f1': 0.5684210526315788, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.35353761725127697, 'eval_precision': 0.5283018867924528, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.5803108808290156, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.34887238033115864, 'eval_precision': 0.5377358490566038, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5906735751295337, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.12it/s]
{'eval_loss': 0.33192070573568344, 'eval_precision': 0.5092592592592593, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5641025641025642, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.31728112883865833, 'eval_precision': 0.5277777777777778, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5846153846153845, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.31253429502248764, 'eval_precision': 0.5370370370370371, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.5948717948717949, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.30953546427190304, 'eval_precision': 0.5321100917431193, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.5918367346938775, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.3080361522734165, 'eval_precision': 0.5523809523809524, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6041666666666666, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.30534525588154793, 'eval_precision': 0.5233644859813084, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.5773195876288659, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:15<00:00,  4.25s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 05:16:18 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.42it/s]
{'eval_loss': 0.30539183132350445, 'eval_precision': 0.5233644859813084, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.5773195876288659, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/14/2021 05:16:18 - INFO - __main__ -   ***** Eval results *****
04/14/2021 05:16:18 - INFO - __main__ -     eval_loss = 0.30539183132350445
04/14/2021 05:16:18 - INFO - __main__ -     eval_precision = 0.5233644859813084
04/14/2021 05:16:18 - INFO - __main__ -     eval_recall = 0.6436781609195402
04/14/2021 05:16:18 - INFO - __main__ -     eval_f1 = 0.5773195876288659
04/14/2021 05:16:18 - INFO - __main__ -     epoch = 60.0
04/14/2021 05:16:18 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 05:16:20 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 05:16:20 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-base-final-8', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_05-16-20_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=8, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 05:16:24 - INFO - filelock -   Lock 140002652842352 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:16:24 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 05:16:24 - INFO - filelock -   Lock 140002652842352 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:16:24 - INFO - filelock -   Lock 139997013326864 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 05:16:24 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 05:16:24 - INFO - filelock -   Lock 139997013326864 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.44it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:25,  4.50s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.2498369216918945, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.9193523824214935, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}██████████████████████| 4/4 [00:00<00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.5743634551763535, 'eval_precision': 0.21621621621621623, 'eval_recall': 0.27586206896551724, 'eval_f1': 0.24242424242424243, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.39226777851581573, 'eval_precision': 0.27522935779816515, 'eval_recall': 0.3448275862068966, 'eval_f1': 0.30612244897959184, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2872703820466995, 'eval_precision': 0.6105263157894737, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6373626373626373, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}7it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.22104652784764767, 'eval_precision': 0.6020408163265306, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6378378378378379, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.19360479712486267, 'eval_precision': 0.65, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6951871657754011, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}<00:00, 15.14it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.209120349958539, 'eval_precision': 0.648936170212766, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6740331491712708, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}14it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2411610772833228, 'eval_precision': 0.6288659793814433, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6630434782608695, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.22971213422715664, 'eval_precision': 0.5670103092783505, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5978260869565217, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.178308199159801, 'eval_precision': 0.71875, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7540983606557378, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}00:00, 15.15it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.21030977996997535, 'eval_precision': 0.7065217391304348, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7262569832402235, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.17364309774711728, 'eval_precision': 0.6979166666666666, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7322404371584699, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.20915732346475124, 'eval_precision': 0.8, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8135593220338982, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}<00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.24338948167860508, 'eval_precision': 0.6947368421052632, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7252747252747253, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.19339260458946228, 'eval_precision': 0.7608695652173914, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.782122905027933, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.24004580359905958, 'eval_precision': 0.723404255319149, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7513812154696133, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.18767614476382732, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7692307692307692, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.21657010167837143, 'eval_precision': 0.7472527472527473, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7640449438202248, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.11it/s]
{'eval_loss': 0.18459865264594555, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.21151426527649164, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.22004573978483677, 'eval_precision': 0.7802197802197802, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.797752808988764, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.23075329978019, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.22373844496905804, 'eval_precision': 0.7717391304347826, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7932960893854749, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.2180590471252799, 'eval_precision': 0.7340425531914894, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7624309392265194, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.21009663306176662, 'eval_precision': 0.6907216494845361, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7282608695652173, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.1866166249383241, 'eval_precision': 0.6907216494845361, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7282608695652173, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.18710650852881372, 'eval_precision': 0.7553191489361702, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7845303867403314, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.20694678276777267, 'eval_precision': 0.8089887640449438, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8181818181818181, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.21718657156452537, 'eval_precision': 0.8, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8135593220338982, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}00:00, 15.15it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.21742769982665777, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.21490756887942553, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.20738997077569366, 'eval_precision': 0.7789473684210526, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8131868131868132, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.2030745055526495, 'eval_precision': 0.7684210526315789, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8021978021978021, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.12it/s]
{'eval_loss': 0.20638825092464685, 'eval_precision': 0.7659574468085106, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7955801104972374, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.20633668592199683, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.20662746811285615, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.25s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 05:20:42 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.39it/s]
{'eval_loss': 0.2067543980665505, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/14/2021 05:20:42 - INFO - __main__ -   ***** Eval results *****
04/14/2021 05:20:42 - INFO - __main__ -     eval_loss = 0.2067543980665505
04/14/2021 05:20:42 - INFO - __main__ -     eval_precision = 0.7634408602150538
04/14/2021 05:20:42 - INFO - __main__ -     eval_recall = 0.8160919540229885
04/14/2021 05:20:42 - INFO - __main__ -     eval_f1 = 0.7888888888888889
04/14/2021 05:20:42 - INFO - __main__ -     epoch = 60.0
04/14/2021 05:20:42 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 05:20:44 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 05:20:44 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-base-final-9', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_05-20-44_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=9, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 05:20:49 - INFO - filelock -   Lock 140219987351920 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:20:49 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 05:20:49 - INFO - filelock -   Lock 140219987351920 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:20:49 - INFO - filelock -   Lock 140214347828240 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 05:20:49 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 05:20:49 - INFO - filelock -   Lock 140214347828240 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.44it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:25,  4.51s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.240263670682907, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.9042142629623413, 'eval_precision': 0.14285714285714285, 'eval_recall': 0.08045977011494253, 'eval_f1': 0.10294117647058823, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.5922595486044884, 'eval_precision': 0.20175438596491227, 'eval_recall': 0.26436781609195403, 'eval_f1': 0.22885572139303484, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.4434868097305298, 'eval_precision': 0.2661290322580645, 'eval_recall': 0.3793103448275862, 'eval_f1': 0.31279620853080564, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.33290865272283554, 'eval_precision': 0.4672897196261682, 'eval_recall': 0.5747126436781609, 'eval_f1': 0.5154639175257731, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.26415927708148956, 'eval_precision': 0.5686274509803921, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6137566137566137, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.22609943151474, 'eval_precision': 0.63, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6737967914438503, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}:00<00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.20124427136033773, 'eval_precision': 0.4954954954954955, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5555555555555555, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.22401647828519344, 'eval_precision': 0.6020408163265306, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6378378378378379, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.23820291832089424, 'eval_precision': 0.5135135135135135, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5757575757575758, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.22698720172047615, 'eval_precision': 0.5728155339805825, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6210526315789473, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.28101672418415546, 'eval_precision': 0.5490196078431373, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.5925925925925927, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.24161699507385492, 'eval_precision': 0.6631578947368421, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6923076923076923, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.26996276155114174, 'eval_precision': 0.5523809523809524, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6041666666666666, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2916747750714421, 'eval_precision': 0.6288659793814433, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6630434782608695, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.30860538221895695, 'eval_precision': 0.6019417475728155, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6526315789473683, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.28858627937734127, 'eval_precision': 0.6565656565656566, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6989247311827956, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.23972238786518574, 'eval_precision': 0.6534653465346535, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7021276595744682, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.21250519435852766, 'eval_precision': 0.7070707070707071, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7526881720430108, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.23560982663184404, 'eval_precision': 0.6310679611650486, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6842105263157895, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2947056442499161, 'eval_precision': 0.5754716981132075, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6321243523316061, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2773274015635252, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.12it/s]
{'eval_loss': 0.2590930201113224, 'eval_precision': 0.638095238095238, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.6979166666666666, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2778581827878952, 'eval_precision': 0.6153846153846154, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6701570680628273, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2683844231069088, 'eval_precision': 0.6018518518518519, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6666666666666667, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.31486282870173454, 'eval_precision': 0.62, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6631016042780749, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}0:00, 15.17it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.30005661211907864, 'eval_precision': 0.6907216494845361, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7282608695652173, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.27018903847783804, 'eval_precision': 0.7040816326530612, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7459459459459459, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2737169712781906, 'eval_precision': 0.6336633663366337, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6808510638297872, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2872787583619356, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7096774193548386, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.3017425648868084, 'eval_precision': 0.6078431372549019, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6560846560846562, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.30614530108869076, 'eval_precision': 0.6078431372549019, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6560846560846562, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.30031255073845387, 'eval_precision': 0.5961538461538461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.649214659685864, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.28997390531003475, 'eval_precision': 0.6, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.65625, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}4/4 [00:00<00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.28846070542931557, 'eval_precision': 0.5904761904761905, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6458333333333334, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.28619103878736496, 'eval_precision': 0.5865384615384616, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6387434554973822, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.28484091628342867, 'eval_precision': 0.5961538461538461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.649214659685864, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:15<00:00,  4.25s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 05:25:06 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.45it/s]
{'eval_loss': 0.2845995705574751, 'eval_precision': 0.5961538461538461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.649214659685864, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/14/2021 05:25:07 - INFO - __main__ -   ***** Eval results *****
04/14/2021 05:25:07 - INFO - __main__ -     eval_loss = 0.2845995705574751
04/14/2021 05:25:07 - INFO - __main__ -     eval_precision = 0.5961538461538461
04/14/2021 05:25:07 - INFO - __main__ -     eval_recall = 0.7126436781609196
04/14/2021 05:25:07 - INFO - __main__ -     eval_f1 = 0.649214659685864
04/14/2021 05:25:07 - INFO - __main__ -     epoch = 60.0
04/14/2021 05:25:07 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 05:25:08 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 05:25:08 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-base-final-10', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_05-25-08_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=10, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 05:25:13 - INFO - filelock -   Lock 140411474860400 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:25:13 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 05:25:13 - INFO - filelock -   Lock 140411474860400 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 05:25:13 - INFO - filelock -   Lock 140405767638032 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 05:25:13 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 05:25:13 - INFO - filelock -   Lock 140405767638032 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.44it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:26,  4.51s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.3148403763771057, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.8797322809696198, 'eval_precision': 0.16326530612244897, 'eval_recall': 0.09195402298850575, 'eval_f1': 0.11764705882352942, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.553349070250988, 'eval_precision': 0.23008849557522124, 'eval_recall': 0.2988505747126437, 'eval_f1': 0.26, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}00<00:00, 15.17it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.4107202813029289, 'eval_precision': 0.44, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.4705882352941177, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}00<00:00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.28842470794916153, 'eval_precision': 0.5098039215686274, 'eval_recall': 0.5977011494252874, 'eval_f1': 0.5502645502645502, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.24921415001153946, 'eval_precision': 0.5566037735849056, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6113989637305699, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.1931644957512617, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.16419276222586632, 'eval_precision': 0.7333333333333333, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7457627118644068, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.98it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.17121814657002687, 'eval_precision': 0.6346153846153846, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6910994764397905, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.22493872232735157, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.99it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.21348210563883185, 'eval_precision': 0.7472527472527473, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7640449438202248, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.54it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.29190943110734224, 'eval_precision': 0.625, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6557377049180328, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}00:00, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.1702177645638585, 'eval_precision': 0.6764705882352942, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7301587301587301, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.2441520495340228, 'eval_precision': 0.7127659574468085, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7403314917127071, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.28723637061193585, 'eval_precision': 0.7191011235955056, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7272727272727273, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2408303318079561, 'eval_precision': 0.6, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.641711229946524, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}00<00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.20061713131144643, 'eval_precision': 0.7052631578947368, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7362637362637363, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.13it/s]
{'eval_loss': 0.1868917685933411, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.23573523480445147, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2083205245435238, 'eval_precision': 0.6464646464646465, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6881720430107527, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.55it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.23325216118246317, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6994535519125683, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.2397289068903774, 'eval_precision': 0.717391304347826, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7374301675977654, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.23429810791276395, 'eval_precision': 0.7419354838709677, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7666666666666667, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.24416100466623902, 'eval_precision': 0.6947368421052632, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7252747252747253, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.22683561337180436, 'eval_precision': 0.7127659574468085, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7403314917127071, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.21898093086201698, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.21884338918607682, 'eval_precision': 0.723404255319149, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7513812154696133, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.24762311449740082, 'eval_precision': 0.7204301075268817, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7444444444444445, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2171917320229113, 'eval_precision': 0.7419354838709677, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7666666666666667, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.20026376331225038, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.19395219022408128, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.1956805274821818, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.19832619559019804, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.19552327098790556, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.16it/s]
{'eval_loss': 0.1946574840694666, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.1961937111336738, 'eval_precision': 0.7777777777777778, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7909604519774011, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.19663526420481503, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:15<00:00,  4.25s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 05:29:30 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.45it/s]
{'eval_loss': 0.1966698233736679, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/14/2021 05:29:31 - INFO - __main__ -   ***** Eval results *****
04/14/2021 05:29:31 - INFO - __main__ -     eval_loss = 0.1966698233736679
04/14/2021 05:29:31 - INFO - __main__ -     eval_precision = 0.7692307692307693
04/14/2021 05:29:31 - INFO - __main__ -     eval_recall = 0.8045977011494253
04/14/2021 05:29:31 - INFO - __main__ -     eval_f1 = 0.7865168539325844
04/14/2021 05:29:31 - INFO - __main__ -     epoch = 60.0
04/14/2021 05:29:31 - INFO - __main__ -     total_flos = 1846853355110400
