/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 04:36:19 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 04:36:19 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-base-final-1', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_04-36-19_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=1, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 04:36:25 - INFO - filelock -   Lock 140423264828096 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:36:25 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 04:36:25 - INFO - filelock -   Lock 140423264828096 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:36:25 - INFO - filelock -   Lock 140423264828048 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 04:36:25 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 04:36:25 - INFO - filelock -   Lock 140423264828048 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.46it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.48s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.34it/s]
{'eval_loss': 1.2670668959617615, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}███████████████████████| 4/4 [00:00<00:00, 15.34it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.34it/s]
{'eval_loss': 0.8762106895446777, 'eval_precision': 0.0784313725490196, 'eval_recall': 0.04597701149425287, 'eval_f1': 0.057971014492753624, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.60it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.38it/s]
{'eval_loss': 0.6173771619796753, 'eval_precision': 0.22115384615384615, 'eval_recall': 0.26436781609195403, 'eval_f1': 0.24083769633507854, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.04it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.32it/s]
{'eval_loss': 0.4629642069339752, 'eval_precision': 0.330188679245283, 'eval_recall': 0.40229885057471265, 'eval_f1': 0.36269430051813467, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.59it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.29it/s]
{'eval_loss': 0.37535954266786575, 'eval_precision': 0.3958333333333333, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.4153005464480874, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.30133820325136185, 'eval_precision': 0.5882352941176471, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6349206349206349, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.26it/s]
{'eval_loss': 0.2968374975025654, 'eval_precision': 0.5588235294117647, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6031746031746031, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
{'eval_loss': 0.2848732266575098, 'eval_precision': 0.5490196078431373, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.5925925925925927, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.26it/s]
{'eval_loss': 0.26237626373767853, 'eval_precision': 0.65625, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6885245901639345, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}:00, 15.27it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.3577546440064907, 'eval_precision': 0.6060606060606061, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6451612903225807, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.28it/s]
{'eval_loss': 0.25755246728658676, 'eval_precision': 0.7096774193548387, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7333333333333333, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2493822742253542, 'eval_precision': 0.6274509803921569, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6772486772486773, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}9it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.2459110338240862, 'eval_precision': 0.7282608695652174, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7486033519553073, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.21312964125536382, 'eval_precision': 0.7065217391304348, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7262569832402235, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.21249403711408377, 'eval_precision': 0.7127659574468085, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7403314917127071, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2865985631942749, 'eval_precision': 0.7340425531914894, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7624309392265194, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.2159202266484499, 'eval_precision': 0.7311827956989247, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7555555555555556, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2086404301226139, 'eval_precision': 0.7446808510638298, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7734806629834253, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.2076228391379118, 'eval_precision': 0.7525773195876289, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7934782608695652, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.23043126240372658, 'eval_precision': 0.7032967032967034, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7191011235955056, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
{'eval_loss': 0.2294727936387062, 'eval_precision': 0.7204301075268817, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7444444444444445, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.24808275699615479, 'eval_precision': 0.6595744680851063, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6850828729281768, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.26265530847012997, 'eval_precision': 0.6631578947368421, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6923076923076923, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.24215620011091232, 'eval_precision': 0.7157894736842105, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7472527472527474, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.24386010318994522, 'eval_precision': 0.7340425531914894, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7624309392265194, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.22409721557050943, 'eval_precision': 0.7777777777777778, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7909604519774011, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.20801304373890162, 'eval_precision': 0.7608695652173914, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.782122905027933, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.2071237387135625, 'eval_precision': 0.7526881720430108, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7777777777777778, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2142048068344593, 'eval_precision': 0.7311827956989247, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7555555555555556, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2447515306994319, 'eval_precision': 0.7282608695652174, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7486033519553073, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.25778487138450146, 'eval_precision': 0.7204301075268817, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7444444444444445, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.263671200722456, 'eval_precision': 0.7282608695652174, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7486033519553073, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.26893427036702633, 'eval_precision': 0.7444444444444445, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7570621468926554, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2660134891048074, 'eval_precision': 0.7555555555555555, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.768361581920904, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.2630403861403465, 'eval_precision': 0.7472527472527473, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7640449438202248, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2618324579671025, 'eval_precision': 0.7204301075268817, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7444444444444445, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.2587255463004112, 'eval_precision': 0.7021276595744681, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.729281767955801, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:13<00:00,  4.23s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 04:40:41 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.48it/s]
{'eval_loss': 0.25824085623025894, 'eval_precision': 0.7021276595744681, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.729281767955801, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/18/2021 04:40:41 - INFO - __main__ -   ***** Eval results *****
04/18/2021 04:40:41 - INFO - __main__ -     eval_loss = 0.25824085623025894
04/18/2021 04:40:41 - INFO - __main__ -     eval_precision = 0.7021276595744681
04/18/2021 04:40:41 - INFO - __main__ -     eval_recall = 0.7586206896551724
04/18/2021 04:40:41 - INFO - __main__ -     eval_f1 = 0.729281767955801
04/18/2021 04:40:41 - INFO - __main__ -     epoch = 60.0
04/18/2021 04:40:41 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 04:40:43 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 04:40:43 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-base-final-2', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_04-40-43_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=2, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 04:40:47 - INFO - filelock -   Lock 140488204782320 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:40:47 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 04:40:47 - INFO - filelock -   Lock 140488204782320 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:40:47 - INFO - filelock -   Lock 140488204782272 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 04:40:47 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 04:40:47 - INFO - filelock -   Lock 140488204782272 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.46it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.49s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.31it/s]
{'eval_loss': 1.4698136746883392, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}███████████████████████| 4/4 [00:00<00:00, 15.33it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.27it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.0992985963821411, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.7444899082183838, 'eval_precision': 0.3283582089552239, 'eval_recall': 0.25287356321839083, 'eval_f1': 0.28571428571428575, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.5592111945152283, 'eval_precision': 0.3333333333333333, 'eval_recall': 0.3563218390804598, 'eval_f1': 0.34444444444444444, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.4699167311191559, 'eval_precision': 0.17094017094017094, 'eval_recall': 0.22988505747126436, 'eval_f1': 0.19607843137254902, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.36517953872680664, 'eval_precision': 0.3162393162393162, 'eval_recall': 0.42528735632183906, 'eval_f1': 0.3627450980392157, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.33631207793951035, 'eval_precision': 0.42592592592592593, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4717948717948718, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.35729530081152916, 'eval_precision': 0.5643564356435643, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6063829787234043, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.2785493955016136, 'eval_precision': 0.6881720430107527, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7111111111111111, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}3it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.33814786560833454, 'eval_precision': 0.7126436781609196, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.7126436781609196, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.3466629646718502, 'eval_precision': 0.5742574257425742, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6170212765957447, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.4165293648838997, 'eval_precision': 0.574468085106383, 'eval_recall': 0.6206896551724138, 'eval_f1': 0.5966850828729281, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}0it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.31495936401188374, 'eval_precision': 0.5894736842105263, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.6153846153846153, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2970184199512005, 'eval_precision': 0.6770833333333334, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7103825136612023, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.32025438267737627, 'eval_precision': 0.6185567010309279, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6521739130434783, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.15it/s]
{'eval_loss': 0.3333894517272711, 'eval_precision': 0.5876288659793815, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6195652173913044, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2804416101425886, 'eval_precision': 0.6702127659574468, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6961325966850829, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.29505419451743364, 'eval_precision': 0.6262626262626263, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6666666666666667, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2841623667627573, 'eval_precision': 0.580952380952381, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6354166666666667, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.3594219833612442, 'eval_precision': 0.5959595959595959, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6344086021505375, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.29268378391861916, 'eval_precision': 0.6354166666666666, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6666666666666666, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3242035247385502, 'eval_precision': 0.625, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6557377049180328, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}0:00, 15.22it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.32396435737609863, 'eval_precision': 0.631578947368421, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6593406593406593, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3159963507205248, 'eval_precision': 0.631578947368421, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6593406593406593, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3259387146681547, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6888888888888889, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.28725095465779305, 'eval_precision': 0.62, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6631016042780749, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}0:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.29165804758667946, 'eval_precision': 0.63, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6737967914438503, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}0:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.28151882626116276, 'eval_precision': 0.594059405940594, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6382978723404255, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.2858415674418211, 'eval_precision': 0.61, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6524064171122995, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}00:00, 15.22it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.29172973707318306, 'eval_precision': 0.6770833333333334, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7103825136612023, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.30091908760368824, 'eval_precision': 0.673469387755102, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7135135135135136, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.31588525138795376, 'eval_precision': 0.6336633663366337, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6808510638297872, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.33354008197784424, 'eval_precision': 0.6224489795918368, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6594594594594595, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.324296185746789, 'eval_precision': 0.5980392156862745, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6455026455026455, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.3101697601377964, 'eval_precision': 0.6116504854368932, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6631578947368421, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.30320783518254757, 'eval_precision': 0.6336633663366337, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6808510638297872, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.30121668614447117, 'eval_precision': 0.6336633663366337, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6808510638297872, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.24s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 04:45:04 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.42it/s]
{'eval_loss': 0.30083649046719074, 'eval_precision': 0.6116504854368932, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6631578947368421, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/18/2021 04:45:04 - INFO - __main__ -   ***** Eval results *****
04/18/2021 04:45:04 - INFO - __main__ -     eval_loss = 0.30083649046719074
04/18/2021 04:45:04 - INFO - __main__ -     eval_precision = 0.6116504854368932
04/18/2021 04:45:04 - INFO - __main__ -     eval_recall = 0.7241379310344828
04/18/2021 04:45:04 - INFO - __main__ -     eval_f1 = 0.6631578947368421
04/18/2021 04:45:04 - INFO - __main__ -     epoch = 60.0
04/18/2021 04:45:04 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 04:45:06 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 04:45:06 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-base-final-3', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_04-45-06_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=3, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 04:45:10 - INFO - filelock -   Lock 140609967053504 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:45:10 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 04:45:10 - INFO - filelock -   Lock 140609967053504 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:45:10 - INFO - filelock -   Lock 140609967053456 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 04:45:10 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 04:45:10 - INFO - filelock -   Lock 140609967053456 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.46it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.48s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 1.296492874622345, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.8852785527706146, 'eval_precision': 0.11764705882352941, 'eval_recall': 0.04597701149425287, 'eval_f1': 0.06611570247933884, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.6072887629270554, 'eval_precision': 0.19791666666666666, 'eval_recall': 0.21839080459770116, 'eval_f1': 0.2076502732240437, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.44827187806367874, 'eval_precision': 0.21621621621621623, 'eval_recall': 0.27586206896551724, 'eval_f1': 0.24242424242424243, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.3426508903503418, 'eval_precision': 0.33636363636363636, 'eval_recall': 0.42528735632183906, 'eval_f1': 0.3756345177664974, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.36865582317113876, 'eval_precision': 0.3508771929824561, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.39800995024875624, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.31053639203310013, 'eval_precision': 0.5849056603773585, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6424870466321244, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.29159151017665863, 'eval_precision': 0.5370370370370371, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.5948717948717949, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.31833742558956146, 'eval_precision': 0.5643564356435643, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6063829787234043, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.32708996161818504, 'eval_precision': 0.5631067961165048, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6105263157894736, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.29831932485103607, 'eval_precision': 0.5384615384615384, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.5863874345549739, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.3196188174188137, 'eval_precision': 0.5089285714285714, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5728643216080401, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.32915053702890873, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.29867927357554436, 'eval_precision': 0.6458333333333334, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6775956284153006, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.3282096404582262, 'eval_precision': 0.5619047619047619, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6145833333333334, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.32486367598176, 'eval_precision': 0.5370370370370371, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.5948717948717949, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}9it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2877780795097351, 'eval_precision': 0.5566037735849056, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6113989637305699, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.29884717985987663, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6702127659574468, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.385478138923645, 'eval_precision': 0.5784313725490197, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6243386243386243, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2895133402198553, 'eval_precision': 0.6336633663366337, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6808510638297872, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.3076286017894745, 'eval_precision': 0.5961538461538461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.649214659685864, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.3390123602002859, 'eval_precision': 0.6597938144329897, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6956521739130436, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.3499189727008343, 'eval_precision': 0.6, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.641711229946524, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}0<00:00, 15.16it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.3898952305316925, 'eval_precision': 0.5728155339805825, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6210526315789473, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.3767179250717163, 'eval_precision': 0.5660377358490566, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6217616580310881, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.3347783535718918, 'eval_precision': 0.64, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6844919786096256, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}<00:00, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.33389529027044773, 'eval_precision': 0.6116504854368932, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6631578947368421, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.346155958250165, 'eval_precision': 0.6116504854368932, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6631578947368421, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.3368383925408125, 'eval_precision': 0.65, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6951871657754011, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.3369117770344019, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.3389374893158674, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.339745020493865, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.3411614615470171, 'eval_precision': 0.6947368421052632, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7252747252747253, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3427693899720907, 'eval_precision': 0.6875, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7213114754098361, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}:00, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.34298579581081867, 'eval_precision': 0.6875, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7213114754098361, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.3408463727682829, 'eval_precision': 0.6875, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7213114754098361, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}:00, 15.17it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.340637119486928, 'eval_precision': 0.6875, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7213114754098361, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}0:00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.23s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 04:49:27 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.49it/s]
{'eval_loss': 0.34081329964101315, 'eval_precision': 0.6875, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7213114754098361, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/18/2021 04:49:27 - INFO - __main__ -   ***** Eval results *****
04/18/2021 04:49:27 - INFO - __main__ -     eval_loss = 0.34081329964101315
04/18/2021 04:49:27 - INFO - __main__ -     eval_precision = 0.6875
04/18/2021 04:49:27 - INFO - __main__ -     eval_recall = 0.7586206896551724
04/18/2021 04:49:27 - INFO - __main__ -     eval_f1 = 0.7213114754098361
04/18/2021 04:49:27 - INFO - __main__ -     epoch = 60.0
04/18/2021 04:49:27 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 04:49:29 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 04:49:29 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-base-final-4', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_04-49-29_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=4, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 04:49:34 - INFO - filelock -   Lock 139794027428544 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:49:34 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 04:49:34 - INFO - filelock -   Lock 139794027428544 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:49:34 - INFO - filelock -   Lock 139794027428496 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 04:49:34 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 04:49:34 - INFO - filelock -   Lock 139794027428496 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.46it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.48s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.28it/s]
{'eval_loss': 1.3237551152706146, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}███████████████████████| 4/4 [00:00<00:00, 15.29it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.26it/s]
{'eval_loss': 0.9829723685979843, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}██████████████████████| 4/4 [00:00<00:00, 15.25it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.6209082305431366, 'eval_precision': 0.20212765957446807, 'eval_recall': 0.21839080459770116, 'eval_f1': 0.2099447513812155, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.44915834069252014, 'eval_precision': 0.32978723404255317, 'eval_recall': 0.3563218390804598, 'eval_f1': 0.3425414364640884, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.3786395192146301, 'eval_precision': 0.42391304347826086, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.4357541899441341, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.3165183365345001, 'eval_precision': 0.504950495049505, 'eval_recall': 0.5862068965517241, 'eval_f1': 0.5425531914893617, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.23815659061074257, 'eval_precision': 0.6210526315789474, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6483516483516483, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.1974264858290553, 'eval_precision': 0.5576923076923077, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6073298429319371, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.26it/s]
{'eval_loss': 0.19735719077289104, 'eval_precision': 0.6458333333333334, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6775956284153006, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.1770209539681673, 'eval_precision': 0.5740740740740741, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6358974358974359, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.17037817277014256, 'eval_precision': 0.5922330097087378, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6421052631578947, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.21705329045653343, 'eval_precision': 0.5686274509803921, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6137566137566137, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2012852942571044, 'eval_precision': 0.65, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6951871657754011, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}<00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.16199171915650368, 'eval_precision': 0.6732673267326733, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.723404255319149, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.1362289795652032, 'eval_precision': 0.6415094339622641, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7046632124352331, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.1842861515469849, 'eval_precision': 0.5980392156862745, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6455026455026455, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.20658808387815952, 'eval_precision': 0.7127659574468085, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7403314917127071, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.18069502944126725, 'eval_precision': 0.7052631578947368, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7362637362637363, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.1660143407061696, 'eval_precision': 0.6568627450980392, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.708994708994709, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.13310962496325374, 'eval_precision': 0.7272727272727273, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7741935483870968, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.150765874190256, 'eval_precision': 0.6634615384615384, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7225130890052356, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.16032460052520037, 'eval_precision': 0.5357142857142857, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6030150753768845, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.16241186438128352, 'eval_precision': 0.6538461538461539, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7120418848167539, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.1554148888681084, 'eval_precision': 0.7070707070707071, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7526881720430108, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.1642208881676197, 'eval_precision': 0.6181818181818182, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.6903553299492386, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.16534258518368006, 'eval_precision': 0.72, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7700534759358287, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}0:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.14718078542500734, 'eval_precision': 0.7058823529411765, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7619047619047619, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.1420438284985721, 'eval_precision': 0.6481481481481481, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7179487179487181, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.14547125063836575, 'eval_precision': 0.696078431372549, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7513227513227513, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.13936884235590696, 'eval_precision': 0.7551020408163265, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.7999999999999999, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.13391984323970973, 'eval_precision': 0.7628865979381443, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8043478260869564, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.13583408505655825, 'eval_precision': 0.7628865979381443, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8043478260869564, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.1350739108165726, 'eval_precision': 0.7628865979381443, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8043478260869564, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.1338966335169971, 'eval_precision': 0.7448979591836735, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7891891891891891, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.1352946275146678, 'eval_precision': 0.7604166666666666, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7978142076502732, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.13654147554188967, 'eval_precision': 0.7448979591836735, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7891891891891891, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.13588149833958596, 'eval_precision': 0.7448979591836735, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7891891891891891, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:13<00:00,  4.23s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 04:53:50 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.51it/s]
{'eval_loss': 0.13581353973131627, 'eval_precision': 0.7448979591836735, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7891891891891891, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/18/2021 04:53:51 - INFO - __main__ -   ***** Eval results *****
04/18/2021 04:53:51 - INFO - __main__ -     eval_loss = 0.13581353973131627
04/18/2021 04:53:51 - INFO - __main__ -     eval_precision = 0.7448979591836735
04/18/2021 04:53:51 - INFO - __main__ -     eval_recall = 0.8390804597701149
04/18/2021 04:53:51 - INFO - __main__ -     eval_f1 = 0.7891891891891891
04/18/2021 04:53:51 - INFO - __main__ -     epoch = 60.0
04/18/2021 04:53:51 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 04:53:52 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 04:53:52 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-base-final-5', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_04-53-52_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=5, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 04:53:57 - INFO - filelock -   Lock 140230016002800 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:53:57 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 04:53:57 - INFO - filelock -   Lock 140230016002800 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:53:57 - INFO - filelock -   Lock 140230016002752 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 04:53:57 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 04:53:57 - INFO - filelock -   Lock 140230016002752 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.45it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.49s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.2413003742694855, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.8851543813943863, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}██████████████████████| 4/4 [00:00<00:00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
{'eval_loss': 0.5756517574191093, 'eval_precision': 0.15126050420168066, 'eval_recall': 0.20689655172413793, 'eval_f1': 0.17475728155339806, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
{'eval_loss': 0.4273923933506012, 'eval_precision': 0.15328467153284672, 'eval_recall': 0.2413793103448276, 'eval_f1': 0.1875, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}00:00, 15.23it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.3483665734529495, 'eval_precision': 0.2767857142857143, 'eval_recall': 0.3563218390804598, 'eval_f1': 0.31155778894472363, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.31006599962711334, 'eval_precision': 0.5339805825242718, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5789473684210527, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.27684385888278484, 'eval_precision': 0.4732142857142857, 'eval_recall': 0.6091954022988506, 'eval_f1': 0.5326633165829145, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.2626430746167898, 'eval_precision': 0.5471698113207547, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6010362694300518, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.2777568381279707, 'eval_precision': 0.57, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6096256684491977, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}0<00:00, 15.23it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.26898006722331047, 'eval_precision': 0.5714285714285714, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.625, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2283700332045555, 'eval_precision': 0.6770833333333334, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7103825136612023, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.25615112483501434, 'eval_precision': 0.5555555555555556, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6153846153846154, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.231205390766263, 'eval_precision': 0.5865384615384616, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6387434554973822, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2583115268498659, 'eval_precision': 0.5377358490566038, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5906735751295337, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.27398410998284817, 'eval_precision': 0.5428571428571428, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5937499999999999, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3070483058691025, 'eval_precision': 0.5523809523809524, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6041666666666666, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2365010604262352, 'eval_precision': 0.6310679611650486, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6842105263157895, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2853696793317795, 'eval_precision': 0.5865384615384616, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6387434554973822, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.24276809580624104, 'eval_precision': 0.5514018691588785, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6082474226804123, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2367399986833334, 'eval_precision': 0.6601941747572816, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7157894736842106, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.23934021964669228, 'eval_precision': 0.5471698113207547, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6010362694300518, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.24349636398255825, 'eval_precision': 0.6530612244897959, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6918918918918919, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.23452556878328323, 'eval_precision': 0.696969696969697, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7419354838709677, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2228110358119011, 'eval_precision': 0.6836734693877551, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7243243243243244, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.24726800434291363, 'eval_precision': 0.6274509803921569, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6772486772486773, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.2893941607326269, 'eval_precision': 0.5327102803738317, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5876288659793815, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.3150836182758212, 'eval_precision': 0.5576923076923077, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6073298429319371, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.3174704946577549, 'eval_precision': 0.5882352941176471, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6349206349206349, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2560011437162757, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.24260205123573542, 'eval_precision': 0.6470588235294118, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6984126984126984, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.24791010748595, 'eval_precision': 0.6274509803921569, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6772486772486773, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.22512165363878012, 'eval_precision': 0.6095238095238096, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6666666666666666, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.21036971546709538, 'eval_precision': 0.6153846153846154, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6701570680628273, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.20808252692222595, 'eval_precision': 0.5925925925925926, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6564102564102564, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.21101514250040054, 'eval_precision': 0.6534653465346535, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7021276595744682, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.2123697390779853, 'eval_precision': 0.6470588235294118, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6984126984126984, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.21308930404484272, 'eval_precision': 0.6534653465346535, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7021276595744682, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.24s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 04:58:13 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.50it/s]
{'eval_loss': 0.2134377332404256, 'eval_precision': 0.6534653465346535, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7021276595744682, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/18/2021 04:58:14 - INFO - __main__ -   ***** Eval results *****
04/18/2021 04:58:14 - INFO - __main__ -     eval_loss = 0.2134377332404256
04/18/2021 04:58:14 - INFO - __main__ -     eval_precision = 0.6534653465346535
04/18/2021 04:58:14 - INFO - __main__ -     eval_recall = 0.7586206896551724
04/18/2021 04:58:14 - INFO - __main__ -     eval_f1 = 0.7021276595744682
04/18/2021 04:58:14 - INFO - __main__ -     epoch = 60.0
04/18/2021 04:58:14 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 04:58:15 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 04:58:15 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-base-final-6', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_04-58-15_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=6, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 04:58:20 - INFO - filelock -   Lock 140702240742128 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:58:20 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 04:58:20 - INFO - filelock -   Lock 140702240742128 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 04:58:20 - INFO - filelock -   Lock 140702240742080 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 04:58:20 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 04:58:20 - INFO - filelock -   Lock 140702240742080 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.45it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.49s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.26it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.3818456530570984, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.9437342137098312, 'eval_precision': 0.22413793103448276, 'eval_recall': 0.14942528735632185, 'eval_f1': 0.1793103448275862, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
{'eval_loss': 0.5832332670688629, 'eval_precision': 0.19387755102040816, 'eval_recall': 0.21839080459770116, 'eval_f1': 0.20540540540540542, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.406729519367218, 'eval_precision': 0.2755905511811024, 'eval_recall': 0.40229885057471265, 'eval_f1': 0.3271028037383178, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}0it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.36110178381204605, 'eval_precision': 0.36893203883495146, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.4, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}0<00:00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.3039749376475811, 'eval_precision': 0.42990654205607476, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.47422680412371127, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
{'eval_loss': 0.2621508426964283, 'eval_precision': 0.5714285714285714, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.625, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}<00:00, 15.25it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.24488362856209278, 'eval_precision': 0.6262626262626263, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6666666666666667, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2593205403536558, 'eval_precision': 0.6813186813186813, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6966292134831461, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.2076805280521512, 'eval_precision': 0.6526315789473685, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6813186813186813, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.2677364042028785, 'eval_precision': 0.5841584158415841, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.627659574468085, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}3it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.22739754896610975, 'eval_precision': 0.5922330097087378, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6421052631578947, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2723777610808611, 'eval_precision': 0.6041666666666666, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.633879781420765, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2605350515805185, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.21236750110983849, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6702127659574468, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.24984814506024122, 'eval_precision': 0.6631578947368421, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6923076923076923, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2632682714611292, 'eval_precision': 0.6, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.641711229946524, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}00<00:00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.26592143066227436, 'eval_precision': 0.62, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6631016042780749, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}00:00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
{'eval_loss': 0.25694322236813605, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2883541788905859, 'eval_precision': 0.6185567010309279, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6521739130434783, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.28432709723711014, 'eval_precision': 0.6391752577319587, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6739130434782609, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.28113683219999075, 'eval_precision': 0.6494845360824743, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6847826086956522, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2580180671066046, 'eval_precision': 0.6274509803921569, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6772486772486773, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.28033847641199827, 'eval_precision': 0.62, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6631016042780749, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}0:00, 15.22it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3112140242010355, 'eval_precision': 0.625, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6557377049180328, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}0:00, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.33052173256874084, 'eval_precision': 0.6458333333333334, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6775956284153006, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.3952656080946326, 'eval_precision': 0.6521739130434783, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.670391061452514, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.35086103063076735, 'eval_precision': 0.6597938144329897, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6956521739130436, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.34239640831947327, 'eval_precision': 0.6428571428571429, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6810810810810811, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.35126796644181013, 'eval_precision': 0.6224489795918368, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6594594594594595, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3451996883377433, 'eval_precision': 0.6354166666666666, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6666666666666666, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
{'eval_loss': 0.3392445961944759, 'eval_precision': 0.648936170212766, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6740331491712708, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.34555216366425157, 'eval_precision': 0.6595744680851063, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6850828729281768, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.345198814291507, 'eval_precision': 0.6595744680851063, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6850828729281768, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.26it/s]
{'eval_loss': 0.32624745601788163, 'eval_precision': 0.7111111111111111, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7231638418079096, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.32351073855534196, 'eval_precision': 0.7111111111111111, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7231638418079096, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.32407536217942834, 'eval_precision': 0.7111111111111111, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7231638418079096, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.24s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 05:02:37 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.46it/s]
{'eval_loss': 0.3242277828976512, 'eval_precision': 0.7111111111111111, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7231638418079096, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/18/2021 05:02:37 - INFO - __main__ -   ***** Eval results *****
04/18/2021 05:02:37 - INFO - __main__ -     eval_loss = 0.3242277828976512
04/18/2021 05:02:37 - INFO - __main__ -     eval_precision = 0.7111111111111111
04/18/2021 05:02:37 - INFO - __main__ -     eval_recall = 0.735632183908046
04/18/2021 05:02:37 - INFO - __main__ -     eval_f1 = 0.7231638418079096
04/18/2021 05:02:37 - INFO - __main__ -     epoch = 60.0
04/18/2021 05:02:37 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 05:02:39 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 05:02:39 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-base-final-7', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_05-02-39_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=7, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 05:02:43 - INFO - filelock -   Lock 140016526830320 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:02:43 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 05:02:44 - INFO - filelock -   Lock 140016526830320 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:02:44 - INFO - filelock -   Lock 140016526830272 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 05:02:44 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 05:02:44 - INFO - filelock -   Lock 140016526830272 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.46it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.49s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.27it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.3871338963508606, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.9902619421482086, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}██████████████████████| 4/4 [00:00<00:00, 15.23it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.6938469707965851, 'eval_precision': 0.2111111111111111, 'eval_recall': 0.21839080459770116, 'eval_f1': 0.2146892655367232, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.27it/s]
{'eval_loss': 0.4748658090829849, 'eval_precision': 0.3263157894736842, 'eval_recall': 0.3563218390804598, 'eval_f1': 0.34065934065934067, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.3845587745308876, 'eval_precision': 0.3978494623655914, 'eval_recall': 0.42528735632183906, 'eval_f1': 0.4111111111111111, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3418038859963417, 'eval_precision': 0.43137254901960786, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.46560846560846564, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3201402463018894, 'eval_precision': 0.5428571428571428, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5937499999999999, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.3065509293228388, 'eval_precision': 0.65625, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6885245901639345, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}0:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.3150542080402374, 'eval_precision': 0.55, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5882352941176471, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}00<00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3331019803881645, 'eval_precision': 0.5188679245283019, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5699481865284974, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}2it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.37967871129512787, 'eval_precision': 0.6703296703296703, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6853932584269663, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.26989700086414814, 'eval_precision': 0.6210526315789474, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6483516483516483, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.34203368052840233, 'eval_precision': 0.5833333333333334, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.6120218579234973, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.3190142884850502, 'eval_precision': 0.574468085106383, 'eval_recall': 0.6206896551724138, 'eval_f1': 0.5966850828729281, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.24603815376758575, 'eval_precision': 0.6483516483516484, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6629213483146068, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.22799879126250744, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6702127659574468, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2916118763387203, 'eval_precision': 0.6853932584269663, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6931818181818182, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.2730162739753723, 'eval_precision': 0.6494845360824743, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6847826086956522, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.24957955442368984, 'eval_precision': 0.64, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6844919786096256, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}<00:00, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2873691860586405, 'eval_precision': 0.594059405940594, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6382978723404255, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.31035707518458366, 'eval_precision': 0.6060606060606061, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6451612903225807, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.3154748920351267, 'eval_precision': 0.6, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.641711229946524, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}0<00:00, 15.22it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.3015421945601702, 'eval_precision': 0.6458333333333334, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6775956284153006, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.31067411601543427, 'eval_precision': 0.6019417475728155, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6526315789473683, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.3155564032495022, 'eval_precision': 0.6039603960396039, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.648936170212766, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2893425729125738, 'eval_precision': 0.6326530612244898, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6702702702702703, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2808798272162676, 'eval_precision': 0.6464646464646465, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6881720430107527, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.26366815343499184, 'eval_precision': 0.5922330097087378, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6421052631578947, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.27056075632572174, 'eval_precision': 0.6213592233009708, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6736842105263158, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.27196846157312393, 'eval_precision': 0.6494845360824743, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6847826086956522, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2853149492293596, 'eval_precision': 0.6530612244897959, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6918918918918919, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.29521339759230614, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.30840311385691166, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.3159862421452999, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.31795766204595566, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.31857713498175144, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.31772544234991074, 'eval_precision': 0.65, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6951871657754011, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}0:00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:13<00:00,  4.23s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 05:07:00 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.48it/s]
{'eval_loss': 0.31749753654003143, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/18/2021 05:07:00 - INFO - __main__ -   ***** Eval results *****
04/18/2021 05:07:00 - INFO - __main__ -     eval_loss = 0.31749753654003143
04/18/2021 05:07:00 - INFO - __main__ -     eval_precision = 0.6632653061224489
04/18/2021 05:07:00 - INFO - __main__ -     eval_recall = 0.7471264367816092
04/18/2021 05:07:00 - INFO - __main__ -     eval_f1 = 0.7027027027027026
04/18/2021 05:07:00 - INFO - __main__ -     epoch = 60.0
04/18/2021 05:07:00 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 05:07:02 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 05:07:02 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-base-final-8', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_05-07-02_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=8, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 05:07:06 - INFO - filelock -   Lock 140525525318384 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:07:06 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 05:07:06 - INFO - filelock -   Lock 140525525318384 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:07:06 - INFO - filelock -   Lock 140525525318336 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 05:07:06 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 05:07:06 - INFO - filelock -   Lock 140525525318336 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.45it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.49s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.27it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.2669792473316193, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
{'eval_loss': 0.9378852993249893, 'eval_precision': 0.07692307692307693, 'eval_recall': 0.034482758620689655, 'eval_f1': 0.04761904761904762, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.5973614901304245, 'eval_precision': 0.22935779816513763, 'eval_recall': 0.28735632183908044, 'eval_f1': 0.25510204081632654, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.4046718701720238, 'eval_precision': 0.19444444444444445, 'eval_recall': 0.3218390804597701, 'eval_f1': 0.2424242424242424, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.33096151798963547, 'eval_precision': 0.5773195876288659, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.6086956521739131, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.29572296887636185, 'eval_precision': 0.6041666666666666, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.633879781420765, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}0it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.2627815315499902, 'eval_precision': 0.6288659793814433, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6630434782608695, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.23320348281413317, 'eval_precision': 0.5700934579439252, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6288659793814434, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.24122538790106773, 'eval_precision': 0.6122448979591837, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6486486486486487, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.20939866732805967, 'eval_precision': 0.6176470588235294, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6666666666666667, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.26062625646591187, 'eval_precision': 0.5523809523809524, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6041666666666666, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.20785483345389366, 'eval_precision': 0.6262626262626263, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6666666666666667, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.19169468246400356, 'eval_precision': 0.7263157894736842, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7582417582417583, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.24860366433858871, 'eval_precision': 0.6842105263157895, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7142857142857142, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.26306684501469135, 'eval_precision': 0.6914893617021277, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7182320441988951, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.2399775693193078, 'eval_precision': 0.6310679611650486, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6842105263157895, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.23104119068011642, 'eval_precision': 0.7040816326530612, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7459459459459459, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2587393815629184, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.26920894253998995, 'eval_precision': 0.6770833333333334, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7103825136612023, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2478251727297902, 'eval_precision': 0.6979166666666666, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7322404371584699, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2541853729635477, 'eval_precision': 0.6224489795918368, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6594594594594595, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.25655424129217863, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.27063986100256443, 'eval_precision': 0.6534653465346535, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7021276595744682, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.14it/s]
{'eval_loss': 0.29844929091632366, 'eval_precision': 0.6956521739130435, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7150837988826816, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.33658444695174694, 'eval_precision': 0.61, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6524064171122995, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}0:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.3661242537200451, 'eval_precision': 0.5959595959595959, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6344086021505375, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.30662878789007664, 'eval_precision': 0.6458333333333334, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6775956284153006, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.2780626658350229, 'eval_precision': 0.6956521739130435, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7150837988826816, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.26427451241761446, 'eval_precision': 0.7252747252747253, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7415730337078651, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2569732265546918, 'eval_precision': 0.7065217391304348, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7262569832402235, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2593328719958663, 'eval_precision': 0.723404255319149, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7513812154696133, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.2573867868632078, 'eval_precision': 0.7021276595744681, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.729281767955801, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2489129640161991, 'eval_precision': 0.7282608695652174, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7486033519553073, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.24512841925024986, 'eval_precision': 0.7142857142857143, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7303370786516854, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.24748255405575037, 'eval_precision': 0.7333333333333333, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7457627118644068, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.24857860151678324, 'eval_precision': 0.7333333333333333, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7457627118644068, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.24885761551558971, 'eval_precision': 0.7282608695652174, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7486033519553073, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:14<00:00,  4.24s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 05:11:23 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.48it/s]
{'eval_loss': 0.24899118207395077, 'eval_precision': 0.7282608695652174, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7486033519553073, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/18/2021 05:11:23 - INFO - __main__ -   ***** Eval results *****
04/18/2021 05:11:23 - INFO - __main__ -     eval_loss = 0.24899118207395077
04/18/2021 05:11:23 - INFO - __main__ -     eval_precision = 0.7282608695652174
04/18/2021 05:11:23 - INFO - __main__ -     eval_recall = 0.7701149425287356
04/18/2021 05:11:23 - INFO - __main__ -     eval_f1 = 0.7486033519553073
04/18/2021 05:11:23 - INFO - __main__ -     epoch = 60.0
04/18/2021 05:11:23 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 05:11:25 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 05:11:25 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-base-final-9', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_05-11-25_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=9, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 05:11:30 - INFO - filelock -   Lock 140476953213680 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:11:30 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 05:11:30 - INFO - filelock -   Lock 140476953213680 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:11:30 - INFO - filelock -   Lock 140476953213632 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 05:11:30 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 05:11:30 - INFO - filelock -   Lock 140476953213632 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.46it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.49s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.26it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.247254729270935, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.27it/s]
{'eval_loss': 0.8985401690006256, 'eval_precision': 0.14583333333333334, 'eval_recall': 0.08045977011494253, 'eval_f1': 0.1037037037037037, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.6178681254386902, 'eval_precision': 0.20192307692307693, 'eval_recall': 0.2413793103448276, 'eval_f1': 0.2198952879581152, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.4214097633957863, 'eval_precision': 0.3238095238095238, 'eval_recall': 0.39080459770114945, 'eval_f1': 0.3541666666666667, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.34569044411182404, 'eval_precision': 0.4857142857142857, 'eval_recall': 0.5862068965517241, 'eval_f1': 0.53125, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}0:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.25761814787983894, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6702127659574468, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.23215455655008554, 'eval_precision': 0.6730769230769231, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7329842931937174, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.18it/s]
{'eval_loss': 0.23243730515241623, 'eval_precision': 0.625, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6557377049180328, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}00:00, 15.19it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.1778386258520186, 'eval_precision': 0.7058823529411765, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7619047619047619, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.26it/s]
{'eval_loss': 0.2033942136913538, 'eval_precision': 0.5816326530612245, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6162162162162163, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.16335429809987545, 'eval_precision': 0.6504854368932039, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7052631578947368, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.17411978635936975, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.17713009007275105, 'eval_precision': 0.6633663366336634, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7127659574468086, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.1997211640700698, 'eval_precision': 0.6458333333333334, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6775956284153006, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.2012271834537387, 'eval_precision': 0.6565656565656566, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6989247311827956, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2307619508355856, 'eval_precision': 0.5714285714285714, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.625, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.21815585810691118, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.17917840229347348, 'eval_precision': 0.7040816326530612, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7459459459459459, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.17075845785439014, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7195767195767195, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.1777899379376322, 'eval_precision': 0.7010309278350515, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7391304347826086, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.19241494475863874, 'eval_precision': 0.69, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7379679144385026, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}0:00, 15.24it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.18781896331347525, 'eval_precision': 0.7340425531914894, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7624309392265194, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.59it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.19201066996902227, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.25it/s]
{'eval_loss': 0.19124730583280325, 'eval_precision': 0.6868686868686869, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7311827956989247, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.1950814495794475, 'eval_precision': 0.6770833333333334, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7103825136612023, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2040500792209059, 'eval_precision': 0.717391304347826, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7374301675977654, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.218354273121804, 'eval_precision': 0.7252747252747253, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7415730337078651, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.59it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.20569846127182245, 'eval_precision': 0.6875, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7213114754098361, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}00, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.19218040350824594, 'eval_precision': 0.6767676767676768, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7204301075268816, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.19003351125866175, 'eval_precision': 0.6504854368932039, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7052631578947368, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.188739194534719, 'eval_precision': 0.6868686868686869, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7311827956989247, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.1878254245966673, 'eval_precision': 0.6979166666666666, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7322404371584699, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.1892427639104426, 'eval_precision': 0.7157894736842105, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7472527472527474, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.18845036905258894, 'eval_precision': 0.7340425531914894, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7624309392265194, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.18873146967962384, 'eval_precision': 0.71875, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7540983606557378, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}0, 15.22it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.18898204434663057, 'eval_precision': 0.71875, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7540983606557378, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}0, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.18921899935230613, 'eval_precision': 0.6868686868686869, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7311827956989247, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.59it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:13<00:00,  4.23s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 05:15:46 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.48it/s]
{'eval_loss': 0.1891786833293736, 'eval_precision': 0.6868686868686869, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7311827956989247, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/18/2021 05:15:46 - INFO - __main__ -   ***** Eval results *****
04/18/2021 05:15:46 - INFO - __main__ -     eval_loss = 0.1891786833293736
04/18/2021 05:15:46 - INFO - __main__ -     eval_precision = 0.6868686868686869
04/18/2021 05:15:46 - INFO - __main__ -     eval_recall = 0.7816091954022989
04/18/2021 05:15:46 - INFO - __main__ -     eval_f1 = 0.7311827956989247
04/18/2021 05:15:46 - INFO - __main__ -     epoch = 60.0
04/18/2021 05:15:46 - INFO - __main__ -     total_flos = 1846853355110400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 05:15:48 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 05:15:48 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-base-final-10', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=4, per_device_eval_batch_size=4, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=4, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_05-15-48_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=10, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 05:15:53 - INFO - filelock -   Lock 139701663369968 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:15:53 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 05:15:53 - INFO - filelock -   Lock 139701663369968 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:15:53 - INFO - filelock -   Lock 139701663369920 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 05:15:53 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 05:15:53 - INFO - filelock -   Lock 139701663369920 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.46it/s]
Epoch:   2%|▉                                                        | 1/60 [00:04<04:24,  4.49s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.31it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.3724559247493744, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 49249422802944, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.9395524263381958, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 3.2, 'total_flos': 98498845605888, 'step': 16}██████████████████████| 4/4 [00:00<00:00, 15.22it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.5778325721621513, 'eval_precision': 0.18699186991869918, 'eval_recall': 0.26436781609195403, 'eval_f1': 0.21904761904761902, 'epoch': 4.8, 'total_flos': 147748268408832, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.43741974234580994, 'eval_precision': 0.32075471698113206, 'eval_recall': 0.39080459770114945, 'eval_f1': 0.35233160621761656, 'epoch': 6.4, 'total_flos': 196997691211776, 'step': 32}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.314200010150671, 'eval_precision': 0.3389830508474576, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.39024390243902435, 'epoch': 8.0, 'total_flos': 246247114014720, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.27450141683220863, 'eval_precision': 0.6363636363636364, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6774193548387097, 'epoch': 9.6, 'total_flos': 295496536817664, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.22016720660030842, 'eval_precision': 0.6565656565656566, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6989247311827956, 'epoch': 11.2, 'total_flos': 344745959620608, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.22499210201203823, 'eval_precision': 0.6470588235294118, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6984126984126984, 'epoch': 12.8, 'total_flos': 393995382423552, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  5.00it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.19145699124783278, 'eval_precision': 0.62, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6631016042780749, 'epoch': 14.4, 'total_flos': 443244805226496, 'step': 72}<00:00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2015975657850504, 'eval_precision': 0.6019417475728155, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6526315789473683, 'epoch': 16.0, 'total_flos': 492494228029440, 'step': 80}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.22033308912068605, 'eval_precision': 0.6458333333333334, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6775956284153006, 'epoch': 17.6, 'total_flos': 541743650832384, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.23127256520092487, 'eval_precision': 0.6020408163265306, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6378378378378379, 'epoch': 19.2, 'total_flos': 590993073635328, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.2270678859204054, 'eval_precision': 0.7065217391304348, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7262569832402235, 'epoch': 20.8, 'total_flos': 640242496438272, 'step': 104}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.24it/s]
{'eval_loss': 0.20998981222510338, 'eval_precision': 0.7052631578947368, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7362637362637363, 'epoch': 22.4, 'total_flos': 689491919241216, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.19180710799992085, 'eval_precision': 0.7171717171717171, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7634408602150538, 'epoch': 24.0, 'total_flos': 738741342044160, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.23278806544840336, 'eval_precision': 0.711340206185567, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.75, 'epoch': 25.6, 'total_flos': 787990764847104, 'step': 128}<00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.19283345574513078, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 27.2, 'total_flos': 837240187650048, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.2638100702315569, 'eval_precision': 0.7, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7486631016042781, 'epoch': 28.8, 'total_flos': 886489610452992, 'step': 144}0<00:00, 15.23it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.59it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.23551402520388365, 'eval_precision': 0.7553191489361702, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7845303867403314, 'epoch': 30.4, 'total_flos': 935739033255936, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.20312559232115746, 'eval_precision': 0.711340206185567, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.75, 'epoch': 32.0, 'total_flos': 984988456058880, 'step': 160}<00:00, 15.21it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.17862345231696963, 'eval_precision': 0.776595744680851, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8066298342541435, 'epoch': 33.6, 'total_flos': 1034237878861824, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.1919594081118703, 'eval_precision': 0.7578947368421053, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7912087912087912, 'epoch': 35.2, 'total_flos': 1083487301664768, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.59it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.2219466557726264, 'eval_precision': 0.8, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8135593220338982, 'epoch': 36.8, 'total_flos': 1132736724467712, 'step': 184}<00:00, 15.18it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.01it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.20302505046129227, 'eval_precision': 0.7578947368421053, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7912087912087912, 'epoch': 38.4, 'total_flos': 1181986147270656, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.23it/s]
{'eval_loss': 0.19725616183131933, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 40.0, 'total_flos': 1231235570073600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.1867241943255067, 'eval_precision': 0.8043478260869565, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8268156424581005, 'epoch': 41.6, 'total_flos': 1280484992876544, 'step': 208}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.17it/s]
{'eval_loss': 0.2081729331985116, 'eval_precision': 0.71, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7593582887700535, 'epoch': 43.2, 'total_flos': 1329734415679488, 'step': 216}00:00, 15.16it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.57it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.19it/s]
{'eval_loss': 0.18791996594518423, 'eval_precision': 0.7422680412371134, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.782608695652174, 'epoch': 44.8, 'total_flos': 1378983838482432, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.18683090899139643, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 46.4, 'total_flos': 1428233261285376, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.19312074035406113, 'eval_precision': 0.7142857142857143, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7567567567567568, 'epoch': 48.0, 'total_flos': 1477482684088320, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.22811733558773994, 'eval_precision': 0.673469387755102, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7135135135135136, 'epoch': 49.6, 'total_flos': 1526732106891264, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.22it/s]
{'eval_loss': 0.24690810777246952, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7096774193548386, 'epoch': 51.2, 'total_flos': 1575981529694208, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.59it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.23942436836659908, 'eval_precision': 0.67, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.716577540106952, 'epoch': 52.8, 'total_flos': 1625230952497152, 'step': 264}00:00, 15.20it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
{'eval_loss': 0.210965889506042, 'eval_precision': 0.7319587628865979, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7717391304347826, 'epoch': 54.4, 'total_flos': 1674480375300096, 'step': 272}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.2021875875070691, 'eval_precision': 0.7684210526315789, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8021978021978021, 'epoch': 56.0, 'total_flos': 1723729798103040, 'step': 280}/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.03it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.20211631432175636, 'eval_precision': 0.7684210526315789, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8021978021978021, 'epoch': 57.6, 'total_flos': 1772979220905984, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.02it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.20it/s]
{'eval_loss': 0.203046808950603, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 59.2, 'total_flos': 1822228643708928, 'step': 296}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.59it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [04:13<00:00,  4.23s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 05:20:09 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.47it/s]
{'eval_loss': 0.20311129745095968, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 60.0, 'total_flos': 1846853355110400, 'step': 300}
04/18/2021 05:20:09 - INFO - __main__ -   ***** Eval results *****
04/18/2021 05:20:09 - INFO - __main__ -     eval_loss = 0.20311129745095968
04/18/2021 05:20:09 - INFO - __main__ -     eval_precision = 0.7473684210526316
04/18/2021 05:20:09 - INFO - __main__ -     eval_recall = 0.8160919540229885
04/18/2021 05:20:09 - INFO - __main__ -     eval_f1 = 0.7802197802197802
04/18/2021 05:20:09 - INFO - __main__ -     epoch = 60.0
04/18/2021 05:20:09 - INFO - __main__ -     total_flos = 1846853355110400
