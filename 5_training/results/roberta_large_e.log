/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 07:14:23 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 07:14:23 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-large-final-1', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_07-14-23_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=1, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 07:14:33 - INFO - filelock -   Lock 140152110098896 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 07:14:33 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 07:14:33 - INFO - filelock -   Lock 140152110098896 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 07:14:33 - INFO - filelock -   Lock 140146465914496 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 07:14:33 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 07:14:33 - INFO - filelock -   Lock 140146465914496 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.39s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.68it/s]
{'eval_loss': 1.3277985379099846, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}██████████████████████| 8/8 [00:00<00:00,  9.68it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.5963641256093979, 'eval_precision': 0.125, 'eval_recall': 0.20689655172413793, 'eval_f1': 0.15584415584415587, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.3408163245767355, 'eval_precision': 0.45614035087719296, 'eval_recall': 0.5977011494252874, 'eval_f1': 0.5174129353233831, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.23435479402542114, 'eval_precision': 0.4491525423728814, 'eval_recall': 0.6091954022988506, 'eval_f1': 0.5170731707317073, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.3060444500297308, 'eval_precision': 0.5471698113207547, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6010362694300518, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.23423380317399278, 'eval_precision': 0.64, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6844919786096256, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}00<00:00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.25063916097860783, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.218081813887693, 'eval_precision': 0.723404255319149, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7513812154696133, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}2it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.19660123845096678, 'eval_precision': 0.5754716981132075, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6321243523316061, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12977964711899403, 'eval_precision': 0.75, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7868852459016394, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}00:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2222363575710915, 'eval_precision': 0.7912087912087912, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8089887640449438, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.21057313273195177, 'eval_precision': 0.7956989247311828, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8222222222222222, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.23755547258770093, 'eval_precision': 0.8131868131868132, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8314606741573034, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.33353667412302457, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.3266224129620241, 'eval_precision': 0.8222222222222222, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8361581920903955, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2612338207436551, 'eval_precision': 0.872093023255814, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8670520231213873, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15299978807615844, 'eval_precision': 0.8222222222222222, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8361581920903955, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.21430034429067746, 'eval_precision': 0.8, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8135593220338982, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}00:00,  9.59it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.30784856600803323, 'eval_precision': 0.7912087912087912, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8089887640449438, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.27123629251582315, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2933826072885495, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7692307692307692, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.26230075005423714, 'eval_precision': 0.8021978021978022, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8202247191011236, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2241296535512447, 'eval_precision': 0.8351648351648352, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.853932584269663, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.27479137335831183, 'eval_precision': 0.8636363636363636, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8685714285714287, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2794708134861139, 'eval_precision': 0.8505747126436781, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8505747126436781, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.22290151345987397, 'eval_precision': 0.8620689655172413, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8620689655172413, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1997124276622344, 'eval_precision': 0.8131868131868132, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8314606741573034, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2564756069350551, 'eval_precision': 0.8222222222222222, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8361581920903955, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.21142048107867595, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.20069334238905867, 'eval_precision': 0.7934782608695652, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8156424581005586, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2099265242313777, 'eval_precision': 0.8131868131868132, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8314606741573034, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.21127554613121902, 'eval_precision': 0.8314606741573034, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8409090909090909, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2169878063359647, 'eval_precision': 0.8021978021978022, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8202247191011236, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.22873014614651765, 'eval_precision': 0.8111111111111111, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8248587570621468, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.23551627642882522, 'eval_precision': 0.8021978021978022, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8202247191011236, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2386702413105013, 'eval_precision': 0.8021978021978022, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8202247191011236, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.24066370974287565, 'eval_precision': 0.8021978021978022, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8202247191011236, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:30<00:00, 13.51s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 07:28:08 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.70it/s]
{'eval_loss': 0.2407990847441397, 'eval_precision': 0.8021978021978022, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8202247191011236, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/14/2021 07:28:09 - INFO - __main__ -   ***** Eval results *****
04/14/2021 07:28:09 - INFO - __main__ -     eval_loss = 0.2407990847441397
04/14/2021 07:28:09 - INFO - __main__ -     eval_precision = 0.8021978021978022
04/14/2021 07:28:09 - INFO - __main__ -     eval_recall = 0.8390804597701149
04/14/2021 07:28:09 - INFO - __main__ -     eval_f1 = 0.8202247191011236
04/14/2021 07:28:09 - INFO - __main__ -     epoch = 60.0
04/14/2021 07:28:09 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 07:28:10 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 07:28:10 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-large-final-2', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_07-28-10_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=2, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 07:28:20 - INFO - filelock -   Lock 140269217315280 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 07:28:20 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 07:28:20 - INFO - filelock -   Lock 140269217315280 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 07:28:20 - INFO - filelock -   Lock 140263573134976 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 07:28:20 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 07:28:20 - INFO - filelock -   Lock 140263573134976 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.98it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:11, 13.41s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 1.1013618931174278, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}██████████████████████| 8/8 [00:00<00:00,  9.63it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.627765279263258, 'eval_precision': 0.136986301369863, 'eval_recall': 0.22988505747126436, 'eval_f1': 0.17167381974248924, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.42358746007084846, 'eval_precision': 0.17647058823529413, 'eval_recall': 0.27586206896551724, 'eval_f1': 0.21524663677130043, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.3692423477768898, 'eval_precision': 0.2647058823529412, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.32286995515695066, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.3078804574906826, 'eval_precision': 0.24812030075187969, 'eval_recall': 0.3793103448275862, 'eval_f1': 0.3, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}00<00:00,  9.59it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.3550565466284752, 'eval_precision': 0.31297709923664124, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.3761467889908257, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2447694158181548, 'eval_precision': 0.5192307692307693, 'eval_recall': 0.6206896551724138, 'eval_f1': 0.5654450261780105, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.20042571472004056, 'eval_precision': 0.6161616161616161, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6559139784946237, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.24595243576914072, 'eval_precision': 0.6435643564356436, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6914893617021277, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1853348613367416, 'eval_precision': 0.6534653465346535, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7021276595744682, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.2091682810569182, 'eval_precision': 0.5673076923076923, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6178010471204188, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.20130819571204484, 'eval_precision': 0.6597938144329897, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6956521739130436, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1657366751896916, 'eval_precision': 0.6442307692307693, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7015706806282722, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.22478927776683122, 'eval_precision': 0.6262626262626263, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6666666666666667, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.3067238616058603, 'eval_precision': 0.6947368421052632, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7252747252747253, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.2203360605490161, 'eval_precision': 0.6736842105263158, 'eval_recall': 0.735632183908046, 'eval_f1': 0.7032967032967034, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.30378401595226023, 'eval_precision': 0.6470588235294118, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6984126984126984, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.33389750327478396, 'eval_precision': 0.6274509803921569, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6772486772486773, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.2958924443919386, 'eval_precision': 0.6078431372549019, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6560846560846562, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2745163548825076, 'eval_precision': 0.5904761904761905, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6458333333333334, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.29871773349441355, 'eval_precision': 0.5660377358490566, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6217616580310881, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.31231650138579425, 'eval_precision': 0.58, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6203208556149732, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}0:00,  9.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.35878084331488935, 'eval_precision': 0.59, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6310160427807486, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}0:00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.3700352205323725, 'eval_precision': 0.6060606060606061, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6451612903225807, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.3837114488978841, 'eval_precision': 0.6185567010309279, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6521739130434783, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.40309601072476653, 'eval_precision': 0.6, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.641711229946524, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}<00:00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.4157962429417239, 'eval_precision': 0.6060606060606061, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6451612903225807, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.4231812575926597, 'eval_precision': 0.6421052631578947, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6703296703296704, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.40736510689384886, 'eval_precision': 0.6391752577319587, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6739130434782609, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.39316097270784667, 'eval_precision': 0.648936170212766, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6740331491712708, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.58it/s]
{'eval_loss': 0.39217806504893815, 'eval_precision': 0.6276595744680851, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6519337016574586, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.3824113613154623, 'eval_precision': 0.6185567010309279, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6521739130434783, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.36936407453686115, 'eval_precision': 0.6224489795918368, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6594594594594595, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.36817839694049326, 'eval_precision': 0.6326530612244898, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6702702702702703, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.36956166203162866, 'eval_precision': 0.6363636363636364, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6774193548387097, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.36506428146640246, 'eval_precision': 0.6326530612244898, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6702702702702703, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.36339906040120695, 'eval_precision': 0.6326530612244898, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6702702702702703, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:31<00:00, 13.53s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 07:41:55 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.69it/s]
{'eval_loss': 0.36331176841122215, 'eval_precision': 0.6326530612244898, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6702702702702703, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/14/2021 07:41:56 - INFO - __main__ -   ***** Eval results *****
04/14/2021 07:41:56 - INFO - __main__ -     eval_loss = 0.36331176841122215
04/14/2021 07:41:56 - INFO - __main__ -     eval_precision = 0.6326530612244898
04/14/2021 07:41:56 - INFO - __main__ -     eval_recall = 0.7126436781609196
04/14/2021 07:41:56 - INFO - __main__ -     eval_f1 = 0.6702702702702703
04/14/2021 07:41:56 - INFO - __main__ -     epoch = 60.0
04/14/2021 07:41:56 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 07:41:58 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 07:41:58 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-large-final-3', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_07-41-58_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=3, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 07:42:08 - INFO - filelock -   Lock 139848589007312 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 07:42:08 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 07:42:08 - INFO - filelock -   Lock 139848589007312 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 07:42:08 - INFO - filelock -   Lock 139842944798336 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 07:42:08 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 07:42:08 - INFO - filelock -   Lock 139842944798336 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.98it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:11, 13.42s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.1134205684065819, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.7021051198244095, 'eval_precision': 0.13157894736842105, 'eval_recall': 0.1724137931034483, 'eval_f1': 0.1492537313432836, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.3938698712736368, 'eval_precision': 0.2558139534883721, 'eval_recall': 0.3793103448275862, 'eval_f1': 0.3055555555555556, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}0it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.3808621559292078, 'eval_precision': 0.391304347826087, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.44554455445544555, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.18934585340321064, 'eval_precision': 0.673469387755102, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7135135135135136, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}0it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.189623995218426, 'eval_precision': 0.7419354838709677, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7666666666666667, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1267055709613487, 'eval_precision': 0.6836734693877551, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7243243243243244, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.1323764123953879, 'eval_precision': 0.7578947368421053, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7912087912087912, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.17003908439073712, 'eval_precision': 0.7555555555555555, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.768361581920904, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.11347876733634621, 'eval_precision': 0.8152173913043478, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8379888268156424, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.13472140760859475, 'eval_precision': 0.7604166666666666, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7978142076502732, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.14084625004034024, 'eval_precision': 0.75, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7868852459016394, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}00:00,  9.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.16132022748934105, 'eval_precision': 0.7263157894736842, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7582417582417583, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.18943170983402524, 'eval_precision': 0.6947368421052632, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7252747252747253, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.18385449997731484, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7096774193548386, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.13899999781278893, 'eval_precision': 0.7526881720430108, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7777777777777778, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1821878608316183, 'eval_precision': 0.7849462365591398, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8111111111111111, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.14696484310843516, 'eval_precision': 0.776595744680851, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8066298342541435, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12460165147786029, 'eval_precision': 0.8064516129032258, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8333333333333334, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.11258579278364778, 'eval_precision': 0.8131868131868132, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8314606741573034, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.12864221967174672, 'eval_precision': 0.696969696969697, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7419354838709677, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.10914121514360886, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.10460788606724236, 'eval_precision': 0.7553191489361702, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7845303867403314, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.08554426912451163, 'eval_precision': 0.8333333333333334, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.847457627118644, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.10035871018772013, 'eval_precision': 0.8064516129032258, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8333333333333334, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.09839969727909192, 'eval_precision': 0.8241758241758241, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8426966292134831, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.09991664064727956, 'eval_precision': 0.8539325842696629, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8636363636363635, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.08839821941000992, 'eval_precision': 0.8522727272727273, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8571428571428572, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.08727987266684067, 'eval_precision': 0.8850574712643678, 'eval_recall': 0.8850574712643678, 'eval_f1': 0.8850574712643678, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.08806300983269466, 'eval_precision': 0.8539325842696629, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8636363636363635, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.09146043731198006, 'eval_precision': 0.8539325842696629, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8636363636363635, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.09571037459954823, 'eval_precision': 0.8241758241758241, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8426966292134831, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.09770447483151656, 'eval_precision': 0.8241758241758241, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8426966292134831, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.09905500384866173, 'eval_precision': 0.8241758241758241, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8426966292134831, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.09940324967101333, 'eval_precision': 0.8241758241758241, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8426966292134831, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.09928537198265985, 'eval_precision': 0.8241758241758241, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8426966292134831, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.09983168519192986, 'eval_precision': 0.8241758241758241, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8426966292134831, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:31<00:00, 13.53s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 07:55:43 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.69it/s]
{'eval_loss': 0.09996676250375458, 'eval_precision': 0.8241758241758241, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8426966292134831, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/14/2021 07:55:44 - INFO - __main__ -   ***** Eval results *****
04/14/2021 07:55:44 - INFO - __main__ -     eval_loss = 0.09996676250375458
04/14/2021 07:55:44 - INFO - __main__ -     eval_precision = 0.8241758241758241
04/14/2021 07:55:44 - INFO - __main__ -     eval_recall = 0.8620689655172413
04/14/2021 07:55:44 - INFO - __main__ -     eval_f1 = 0.8426966292134831
04/14/2021 07:55:44 - INFO - __main__ -     epoch = 60.0
04/14/2021 07:55:44 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 07:55:46 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 07:55:46 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-large-final-4', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_07-55-46_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=4, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 07:55:56 - INFO - filelock -   Lock 140122225084928 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 07:55:56 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 07:55:56 - INFO - filelock -   Lock 140122225084928 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 07:55:56 - INFO - filelock -   Lock 140116312215168 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 07:55:56 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 07:55:56 - INFO - filelock -   Lock 140116312215168 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.98it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:10, 13.40s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 1.1234282776713371, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}██████████████████████| 8/8 [00:00<00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.5633779838681221, 'eval_precision': 0.11464968152866242, 'eval_recall': 0.20689655172413793, 'eval_f1': 0.14754098360655737, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.42991430684924126, 'eval_precision': 0.2786885245901639, 'eval_recall': 0.39080459770114945, 'eval_f1': 0.32535885167464107, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.33863189071416855, 'eval_precision': 0.3114754098360656, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.36363636363636365, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2880415916442871, 'eval_precision': 0.34959349593495936, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.40952380952380957, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.2577598188072443, 'eval_precision': 0.3125, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.37209302325581395, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}0:00,  9.59it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.24094083812087774, 'eval_precision': 0.38524590163934425, 'eval_recall': 0.5402298850574713, 'eval_f1': 0.44976076555023925, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.2122942889109254, 'eval_precision': 0.3492063492063492, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.41314553990610325, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.29577504843473434, 'eval_precision': 0.20279720279720279, 'eval_recall': 0.3333333333333333, 'eval_f1': 0.25217391304347825, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.2292186263948679, 'eval_precision': 0.352, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.41509433962264153, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}0:00,  9.58it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.22074106335639954, 'eval_precision': 0.35658914728682173, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.425925925925926, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.21678663417696953, 'eval_precision': 0.504424778761062, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5700000000000001, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1722864576149732, 'eval_precision': 0.5700934579439252, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6288659793814434, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.16126143251312897, 'eval_precision': 0.6320754716981132, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.6943005181347149, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.2933395493309945, 'eval_precision': 0.7252747252747253, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7415730337078651, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.31686610024189577, 'eval_precision': 0.6595744680851063, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6850828729281768, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.18391016707755625, 'eval_precision': 0.6018518518518519, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6666666666666667, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.15859277780691627, 'eval_precision': 0.6862745098039216, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7407407407407408, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2349667893286096, 'eval_precision': 0.6875, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7213114754098361, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}:00,  9.59it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.25043550663031056, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.27638628182467073, 'eval_precision': 0.6458333333333334, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6775956284153006, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.15718520733935293, 'eval_precision': 0.5981308411214953, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6597938144329896, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.21536713390378281, 'eval_precision': 0.5545454545454546, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6192893401015228, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.22486300044693053, 'eval_precision': 0.580952380952381, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6354166666666667, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.2169118263409473, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6702127659574468, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.16864225607423577, 'eval_precision': 0.6534653465346535, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7021276595744682, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.16548761853482574, 'eval_precision': 0.6407766990291263, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6947368421052632, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1787977539424901, 'eval_precision': 0.6310679611650486, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6842105263157895, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1817311401682673, 'eval_precision': 0.6470588235294118, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6984126984126984, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.18520573739806423, 'eval_precision': 0.6470588235294118, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6984126984126984, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.18764573846419808, 'eval_precision': 0.6534653465346535, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7021276595744682, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.18675534278008854, 'eval_precision': 0.6568627450980392, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.708994708994709, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.18440019682748243, 'eval_precision': 0.6470588235294118, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.6984126984126984, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.17997955395185272, 'eval_precision': 0.6310679611650486, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6842105263157895, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.17555294486555795, 'eval_precision': 0.6504854368932039, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7052631578947368, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.17511998177906207, 'eval_precision': 0.6504854368932039, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7052631578947368, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.17638580920356617, 'eval_precision': 0.6504854368932039, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7052631578947368, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:31<00:00, 13.52s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 08:09:31 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.70it/s]
{'eval_loss': 0.17662552965157374, 'eval_precision': 0.6504854368932039, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7052631578947368, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/14/2021 08:09:32 - INFO - __main__ -   ***** Eval results *****
04/14/2021 08:09:32 - INFO - __main__ -     eval_loss = 0.17662552965157374
04/14/2021 08:09:32 - INFO - __main__ -     eval_precision = 0.6504854368932039
04/14/2021 08:09:32 - INFO - __main__ -     eval_recall = 0.7701149425287356
04/14/2021 08:09:32 - INFO - __main__ -     eval_f1 = 0.7052631578947368
04/14/2021 08:09:32 - INFO - __main__ -     epoch = 60.0
04/14/2021 08:09:32 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 08:09:34 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 08:09:34 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-large-final-5', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_08-09-34_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=5, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 08:09:43 - INFO - filelock -   Lock 139960566295040 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 08:09:43 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 08:09:43 - INFO - filelock -   Lock 139960566295040 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 08:09:43 - INFO - filelock -   Lock 139954854845792 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 08:09:43 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 08:09:43 - INFO - filelock -   Lock 139954854845792 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:10, 13.40s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.65it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.4881412163376808, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.7090350985527039, 'eval_precision': 0.14953271028037382, 'eval_recall': 0.1839080459770115, 'eval_f1': 0.1649484536082474, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.4189911559224129, 'eval_precision': 0.22602739726027396, 'eval_recall': 0.3793103448275862, 'eval_f1': 0.28326180257510725, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.27539979573339224, 'eval_precision': 0.46551724137931033, 'eval_recall': 0.6206896551724138, 'eval_f1': 0.5320197044334976, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.32107256166636944, 'eval_precision': 0.4117647058823529, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.4444444444444445, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.16699027200229466, 'eval_precision': 0.8089887640449438, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8181818181818181, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20603781007230282, 'eval_precision': 0.6185567010309279, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6521739130434783, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14990923670120537, 'eval_precision': 0.71875, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7540983606557378, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1916881367797032, 'eval_precision': 0.7252747252747253, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7415730337078651, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.17487985081970692, 'eval_precision': 0.7752808988764045, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7840909090909092, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13380556053016335, 'eval_precision': 0.7282608695652174, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7486033519553073, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.10508381726685911, 'eval_precision': 0.68, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7272727272727274, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}00:00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12762878235662356, 'eval_precision': 0.8222222222222222, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8361581920903955, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.15217381101683713, 'eval_precision': 0.7346938775510204, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7783783783783784, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.10013514904858312, 'eval_precision': 0.7956989247311828, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8222222222222222, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.11126052687177435, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1418830798502313, 'eval_precision': 0.8111111111111111, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8248587570621468, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.12685333498666296, 'eval_precision': 0.7684210526315789, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8021978021978021, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.11838535786955617, 'eval_precision': 0.7934782608695652, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8156424581005586, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14139156471355818, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.12997957825427875, 'eval_precision': 0.8131868131868132, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8314606741573034, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.11167519213631749, 'eval_precision': 0.7525773195876289, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7934782608695652, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14758164445811417, 'eval_precision': 0.7684210526315789, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8021978021978021, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15132934308348922, 'eval_precision': 0.7789473684210526, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8131868131868132, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1449962638944271, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.154059169055472, 'eval_precision': 0.7628865979381443, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8043478260869564, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14784866638001404, 'eval_precision': 0.7628865979381443, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8043478260869564, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.14281125277921092, 'eval_precision': 0.7628865979381443, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8043478260869564, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14260028893477283, 'eval_precision': 0.7628865979381443, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8043478260869564, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14506880261160404, 'eval_precision': 0.7628865979381443, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8043478260869564, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14723782096825744, 'eval_precision': 0.7628865979381443, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8043478260869564, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1525226171088434, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15310341856093146, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15183832160255406, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15094338670496654, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.15066047952677764, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.15053050496680953, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:30<00:00, 13.51s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 08:23:18 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.71it/s]
{'eval_loss': 0.1506745415754267, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/14/2021 08:23:19 - INFO - __main__ -   ***** Eval results *****
04/14/2021 08:23:19 - INFO - __main__ -     eval_loss = 0.1506745415754267
04/14/2021 08:23:19 - INFO - __main__ -     eval_precision = 0.7708333333333334
04/14/2021 08:23:19 - INFO - __main__ -     eval_recall = 0.8505747126436781
04/14/2021 08:23:19 - INFO - __main__ -     eval_f1 = 0.8087431693989071
04/14/2021 08:23:19 - INFO - __main__ -     epoch = 60.0
04/14/2021 08:23:19 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 08:23:20 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 08:23:20 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-large-final-6', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_08-23-20_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=6, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 08:23:30 - INFO - filelock -   Lock 139807602915840 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 08:23:30 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 08:23:30 - INFO - filelock -   Lock 139807602915840 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 08:23:30 - INFO - filelock -   Lock 139801958698336 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 08:23:30 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 08:23:30 - INFO - filelock -   Lock 139801958698336 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.39s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.4822726100683212, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.65it/s]
{'eval_loss': 0.6786842048168182, 'eval_precision': 0.05555555555555555, 'eval_recall': 0.09195402298850575, 'eval_f1': 0.06926406926406926, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.4237584061920643, 'eval_precision': 0.21804511278195488, 'eval_recall': 0.3333333333333333, 'eval_f1': 0.2636363636363636, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.30522237345576286, 'eval_precision': 0.5094339622641509, 'eval_recall': 0.6206896551724138, 'eval_f1': 0.5595854922279793, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.22692563198506832, 'eval_precision': 0.6853932584269663, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6931818181818182, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.22597363567911088, 'eval_precision': 0.7010309278350515, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7391304347826086, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1203200533054769, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13528880546800792, 'eval_precision': 0.7978723404255319, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8287292817679558, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.17903083859710023, 'eval_precision': 0.7934782608695652, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8156424581005586, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.24987978261196986, 'eval_precision': 0.7802197802197802, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.797752808988764, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.2553201444679871, 'eval_precision': 0.7419354838709677, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7666666666666667, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2675102774228435, 'eval_precision': 0.8505747126436781, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8505747126436781, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.25520833206246607, 'eval_precision': 0.8390804597701149, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8390804597701149, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.24864313073339872, 'eval_precision': 0.8064516129032258, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8333333333333334, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2759927976076142, 'eval_precision': 0.7029702970297029, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7553191489361702, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2604877799458336, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.17163913836702704, 'eval_precision': 0.7244897959183674, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7675675675675676, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.12976259560673498, 'eval_precision': 0.8152173913043478, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8379888268156424, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.11189397865928186, 'eval_precision': 0.7659574468085106, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7955801104972374, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14387540843927127, 'eval_precision': 0.7244897959183674, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7675675675675676, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15326916110461752, 'eval_precision': 0.7319587628865979, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7717391304347826, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14129905407389742, 'eval_precision': 0.7525773195876289, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7934782608695652, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.12677866400554194, 'eval_precision': 0.7659574468085106, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7955801104972374, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14336349538643844, 'eval_precision': 0.7010309278350515, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7391304347826086, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12843463655553933, 'eval_precision': 0.7216494845360825, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7608695652173912, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.15880751567601692, 'eval_precision': 0.7422680412371134, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.782608695652174, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.17430999119824264, 'eval_precision': 0.696078431372549, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7513227513227513, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.16903172097772767, 'eval_precision': 0.7525773195876289, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7934782608695652, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.15898192658642074, 'eval_precision': 0.75, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7868852459016394, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}0:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1554100207195006, 'eval_precision': 0.75, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7868852459016394, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.13982876466252492, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.13462257457013038, 'eval_precision': 0.7142857142857143, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7567567567567568, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.13376732191863994, 'eval_precision': 0.7142857142857143, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7567567567567568, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.13510986595247232, 'eval_precision': 0.7291666666666666, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7650273224043717, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.13608500643022126, 'eval_precision': 0.7291666666666666, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7650273224043717, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.13699430468932405, 'eval_precision': 0.7446808510638298, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7734806629834253, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.13740800971118006, 'eval_precision': 0.7446808510638298, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7734806629834253, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.50s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 08:37:04 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.72it/s]
{'eval_loss': 0.13734603282318858, 'eval_precision': 0.7446808510638298, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7734806629834253, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/14/2021 08:37:05 - INFO - __main__ -   ***** Eval results *****
04/14/2021 08:37:05 - INFO - __main__ -     eval_loss = 0.13734603282318858
04/14/2021 08:37:05 - INFO - __main__ -     eval_precision = 0.7446808510638298
04/14/2021 08:37:05 - INFO - __main__ -     eval_recall = 0.8045977011494253
04/14/2021 08:37:05 - INFO - __main__ -     eval_f1 = 0.7734806629834253
04/14/2021 08:37:05 - INFO - __main__ -     epoch = 60.0
04/14/2021 08:37:05 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 08:37:06 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 08:37:06 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-large-final-7', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_08-37-06_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=7, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 08:37:16 - INFO - filelock -   Lock 140023374703104 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 08:37:16 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 08:37:16 - INFO - filelock -   Lock 140023374703104 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 08:37:16 - INFO - filelock -   Lock 140017730485600 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 08:37:16 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 08:37:16 - INFO - filelock -   Lock 140017730485600 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.39s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.66it/s]
{'eval_loss': 1.112464778125286, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}███████████████████████| 8/8 [00:00<00:00,  9.65it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.65it/s]
{'eval_loss': 0.7353879064321518, 'eval_precision': 0.07920792079207921, 'eval_recall': 0.09195402298850575, 'eval_f1': 0.0851063829787234, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.47732945159077644, 'eval_precision': 0.17164179104477612, 'eval_recall': 0.26436781609195403, 'eval_f1': 0.2081447963800905, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.41528544947505, 'eval_precision': 0.2396694214876033, 'eval_recall': 0.3333333333333333, 'eval_f1': 0.27884615384615385, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}63it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.3883491661399603, 'eval_precision': 0.18309859154929578, 'eval_recall': 0.2988505747126437, 'eval_f1': 0.22707423580786026, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.251667819917202, 'eval_precision': 0.2857142857142857, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.34545454545454546, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}2it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2282112669199705, 'eval_precision': 0.3515625, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.4186046511627907, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.20596839301288128, 'eval_precision': 0.25735294117647056, 'eval_recall': 0.40229885057471265, 'eval_f1': 0.3139013452914798, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.29877558443695307, 'eval_precision': 0.26666666666666666, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.32432432432432434, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.3275813711807132, 'eval_precision': 0.32, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.37735849056603776, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}0:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.3090051282197237, 'eval_precision': 0.2518518518518518, 'eval_recall': 0.39080459770114945, 'eval_f1': 0.3063063063063063, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2552180401980877, 'eval_precision': 0.25757575757575757, 'eval_recall': 0.39080459770114945, 'eval_f1': 0.31050228310502287, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.27307284716516733, 'eval_precision': 0.25925925925925924, 'eval_recall': 0.40229885057471265, 'eval_f1': 0.3153153153153153, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.3167509585618973, 'eval_precision': 0.2803030303030303, 'eval_recall': 0.42528735632183906, 'eval_f1': 0.3378995433789954, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2860266310162842, 'eval_precision': 0.2595419847328244, 'eval_recall': 0.39080459770114945, 'eval_f1': 0.3119266055045872, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.28908672789111733, 'eval_precision': 0.31746031746031744, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.3755868544600939, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2675716448575258, 'eval_precision': 0.3253968253968254, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.3849765258215963, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.29437308432534337, 'eval_precision': 0.3602941176470588, 'eval_recall': 0.5632183908045977, 'eval_f1': 0.43946188340807174, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.240190664306283, 'eval_precision': 0.328125, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.39069767441860465, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}0,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.21721796412020922, 'eval_precision': 0.3492063492063492, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.41314553990610325, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.2261432553641498, 'eval_precision': 0.3178294573643411, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.37962962962962965, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.23667455092072487, 'eval_precision': 0.3333333333333333, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.39436619718309857, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.24018819257616997, 'eval_precision': 0.344, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.40566037735849053, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.23494610469788313, 'eval_precision': 0.3181818181818182, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.3835616438356164, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.23596799047663808, 'eval_precision': 0.3111111111111111, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.37837837837837834, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.23681538924574852, 'eval_precision': 0.29545454545454547, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.35616438356164387, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.23417805461212993, 'eval_precision': 0.31451612903225806, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.3696682464454976, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.2342206588946283, 'eval_precision': 0.34959349593495936, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.40952380952380957, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.22471744613721967, 'eval_precision': 0.312, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.3679245283018868, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}:00,  9.63it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.23274948867037892, 'eval_precision': 0.3125, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.37209302325581395, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240},  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.22573139891028404, 'eval_precision': 0.31496062992125984, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.37383177570093457, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.24197322688996792, 'eval_precision': 0.3046875, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.36279069767441857, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256} 9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2419497319497168, 'eval_precision': 0.3387096774193548, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.39810426540284355, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.21959247067570686, 'eval_precision': 0.4649122807017544, 'eval_recall': 0.6091954022988506, 'eval_f1': 0.527363184079602, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.18686480284668505, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7096774193548386, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.1800120297120884, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.17683287599356845, 'eval_precision': 0.7263157894736842, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7582417582417583, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.49s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 08:50:49 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.73it/s]
{'eval_loss': 0.17635371998767368, 'eval_precision': 0.7263157894736842, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7582417582417583, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/14/2021 08:50:50 - INFO - __main__ -   ***** Eval results *****
04/14/2021 08:50:50 - INFO - __main__ -     eval_loss = 0.17635371998767368
04/14/2021 08:50:50 - INFO - __main__ -     eval_precision = 0.7263157894736842
04/14/2021 08:50:50 - INFO - __main__ -     eval_recall = 0.7931034482758621
04/14/2021 08:50:50 - INFO - __main__ -     eval_f1 = 0.7582417582417583
04/14/2021 08:50:50 - INFO - __main__ -     epoch = 60.0
04/14/2021 08:50:50 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 08:50:52 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 08:50:52 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-large-final-8', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_08-50-52_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=8, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 08:51:02 - INFO - filelock -   Lock 140048042482128 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 08:51:02 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 08:51:02 - INFO - filelock -   Lock 140048042482128 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 08:51:02 - INFO - filelock -   Lock 140042398269056 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 08:51:02 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 08:51:02 - INFO - filelock -   Lock 140042398269056 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:10, 13.39s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.65it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.1560402736067772, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.65it/s]
{'eval_loss': 0.6262434720993042, 'eval_precision': 0.10126582278481013, 'eval_recall': 0.1839080459770115, 'eval_f1': 0.1306122448979592, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.3958519231528044, 'eval_precision': 0.20422535211267606, 'eval_recall': 0.3333333333333333, 'eval_f1': 0.25327510917030566, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.2870816756039858, 'eval_precision': 0.42592592592592593, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4717948717948718, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.2733549578115344, 'eval_precision': 0.5288461538461539, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5759162303664922, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}63it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.22237419104203582, 'eval_precision': 0.5045871559633027, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5612244897959184, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.21209904737770557, 'eval_precision': 0.5420560747663551, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.5979381443298968, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.16229824163019657, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13683002127800137, 'eval_precision': 0.6634615384615384, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7225130890052356, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.18135660426924005, 'eval_precision': 0.6018518518518519, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6666666666666667, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20963949570432305, 'eval_precision': 0.4864864864864865, 'eval_recall': 0.6206896551724138, 'eval_f1': 0.5454545454545455, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1917636323487386, 'eval_precision': 0.5922330097087378, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6421052631578947, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.24039658368565142, 'eval_precision': 0.7065217391304348, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7262569832402235, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13085774963838048, 'eval_precision': 0.5779816513761468, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6428571428571428, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1480271415784955, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7096774193548386, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.15298338403226808, 'eval_precision': 0.5980392156862745, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6455026455026455, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.15037527814274654, 'eval_precision': 0.7010309278350515, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7391304347826086, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1496033623116091, 'eval_precision': 0.5904761904761905, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6458333333333334, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14916668622754514, 'eval_precision': 0.64, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6844919786096256, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}00:00,  9.63it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.12314684293232858, 'eval_precision': 0.6565656565656566, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6989247311827956, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14387599160545506, 'eval_precision': 0.7040816326530612, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7459459459459459, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.154298613400897, 'eval_precision': 0.7142857142857143, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7567567567567568, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15546108823036775, 'eval_precision': 0.7040816326530612, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7459459459459459, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.15621968900086358, 'eval_precision': 0.71875, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7540983606557378, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}0,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.15727903426159173, 'eval_precision': 0.7040816326530612, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7459459459459459, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.14683420560322702, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7195767195767195, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.15379518014378846, 'eval_precision': 0.696969696969697, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7419354838709677, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14427111390978098, 'eval_precision': 0.7340425531914894, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7624309392265194, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14179126755334437, 'eval_precision': 0.75, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.770949720670391, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}00:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.13016591151244938, 'eval_precision': 0.71875, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7540983606557378, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}0,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.12800561729818583, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.12023958773352206, 'eval_precision': 0.7472527472527473, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7640449438202248, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.12628731550648808, 'eval_precision': 0.7840909090909091, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7885714285714285, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12903265049681067, 'eval_precision': 0.7840909090909091, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7885714285714285, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.1302387184696272, 'eval_precision': 0.7555555555555555, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.768361581920904, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1311900590080768, 'eval_precision': 0.7666666666666667, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7796610169491527, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.13138396991416812, 'eval_precision': 0.7777777777777778, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7909604519774011, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.50s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 09:04:35 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.74it/s]
{'eval_loss': 0.131258659879677, 'eval_precision': 0.7777777777777778, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7909604519774011, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/14/2021 09:04:36 - INFO - __main__ -   ***** Eval results *****
04/14/2021 09:04:36 - INFO - __main__ -     eval_loss = 0.131258659879677
04/14/2021 09:04:36 - INFO - __main__ -     eval_precision = 0.7777777777777778
04/14/2021 09:04:36 - INFO - __main__ -     eval_recall = 0.8045977011494253
04/14/2021 09:04:36 - INFO - __main__ -     eval_f1 = 0.7909604519774011
04/14/2021 09:04:36 - INFO - __main__ -     epoch = 60.0
04/14/2021 09:04:36 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 09:04:38 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 09:04:38 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-large-final-9', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_09-04-38_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=9, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 09:04:47 - INFO - filelock -   Lock 140259422325248 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 09:04:47 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 09:04:47 - INFO - filelock -   Lock 140259422325248 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 09:04:47 - INFO - filelock -   Lock 140253778140512 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 09:04:47 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 09:04:48 - INFO - filelock -   Lock 140253778140512 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.38s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.66it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.0973883718252182, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.65it/s]
{'eval_loss': 0.693729393184185, 'eval_precision': 0.1951219512195122, 'eval_recall': 0.1839080459770115, 'eval_f1': 0.1893491124260355, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}64it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.5256459936499596, 'eval_precision': 0.1780821917808219, 'eval_recall': 0.2988505747126437, 'eval_f1': 0.22317596566523606, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.4643200431019068, 'eval_precision': 0.17647058823529413, 'eval_recall': 0.27586206896551724, 'eval_f1': 0.21524663677130043, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2724397871643305, 'eval_precision': 0.28346456692913385, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.3364485981308411, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.18636719230562449, 'eval_precision': 0.5925925925925926, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6564102564102564, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}3it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.17808525636792183, 'eval_precision': 0.6435643564356436, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6914893617021277, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.20806347485631704, 'eval_precision': 0.5462962962962963, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6051282051282051, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14119491359451786, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7692307692307692, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2022299264499452, 'eval_precision': 0.65, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6951871657754011, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}<00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.1466223953757435, 'eval_precision': 0.72, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7700534759358287, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}<00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.12736786004097667, 'eval_precision': 0.7448979591836735, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7891891891891891, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12214246590156108, 'eval_precision': 0.7422680412371134, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.782608695652174, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.12762117727834266, 'eval_precision': 0.7448979591836735, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7891891891891891, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.1391514354472747, 'eval_precision': 0.8021978021978022, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8202247191011236, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14649602451754618, 'eval_precision': 0.8, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8135593220338982, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}00:00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.12543323084537406, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.13402136699005496, 'eval_precision': 0.711340206185567, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.75, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.17277019023458706, 'eval_precision': 0.7553191489361702, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7845303867403314, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.17413446983118774, 'eval_precision': 0.7010309278350515, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7391304347826086, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.1873025460372446, 'eval_precision': 0.6979166666666666, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7322404371584699, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.19279325037132367, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.18916542979422957, 'eval_precision': 0.6767676767676768, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7204301075268816, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.19957975222496316, 'eval_precision': 0.7526881720430108, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7777777777777778, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.23911315623990959, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.238270136032952, 'eval_precision': 0.7608695652173914, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.782122905027933, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.21589697111267014, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1954761825290916, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.19059919455321506, 'eval_precision': 0.776595744680851, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8066298342541435, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.19787952202386805, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.20435808304137026, 'eval_precision': 0.782608695652174, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8044692737430168, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2091126213217649, 'eval_precision': 0.8, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8135593220338982, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}<00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2145994152451749, 'eval_precision': 0.7912087912087912, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8089887640449438, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.22049914270610316, 'eval_precision': 0.8, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8135593220338982, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}00:00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.22674130200903164, 'eval_precision': 0.7526881720430108, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7777777777777778, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.22494137049579876, 'eval_precision': 0.7526881720430108, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7777777777777778, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.22234347551057, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7692307692307692, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.49s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 09:18:20 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.74it/s]
{'eval_loss': 0.2218388336841599, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7692307692307692, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/14/2021 09:18:21 - INFO - __main__ -   ***** Eval results *****
04/14/2021 09:18:21 - INFO - __main__ -     eval_loss = 0.2218388336841599
04/14/2021 09:18:21 - INFO - __main__ -     eval_precision = 0.7368421052631579
04/14/2021 09:18:21 - INFO - __main__ -     eval_recall = 0.8045977011494253
04/14/2021 09:18:21 - INFO - __main__ -     eval_f1 = 0.7692307692307692
04/14/2021 09:18:21 - INFO - __main__ -     epoch = 60.0
04/14/2021 09:18:21 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/14/2021 09:18:23 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/14/2021 09:18:23 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e/roberta-large-final-10', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr14_09-18-23_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=10, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/14/2021 09:18:33 - INFO - filelock -   Lock 140308168014336 acquired on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 09:18:33 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512
04/14/2021 09:18:33 - INFO - filelock -   Lock 140308168014336 released on ./3_iob_data/context/train_entity/cached_train_RobertaTokenizer_512.lock
04/14/2021 09:18:33 - INFO - filelock -   Lock 140302523788640 acquired on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/14/2021 09:18:33 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512
04/14/2021 09:18:33 - INFO - filelock -   Lock 140302523788640 released on ./3_iob_data/context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.38s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.66it/s]
{'eval_loss': 1.2233240082859993, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}██████████████████████| 8/8 [00:00<00:00,  9.65it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.65it/s]
{'eval_loss': 0.6297374106943607, 'eval_precision': 0.09316770186335403, 'eval_recall': 0.1724137931034483, 'eval_f1': 0.12096774193548386, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.42930714786052704, 'eval_precision': 0.22302158273381295, 'eval_recall': 0.3563218390804598, 'eval_f1': 0.2743362831858407, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.2235254179686308, 'eval_precision': 0.5757575757575758, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.6129032258064515, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}3it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.2270835847593844, 'eval_precision': 0.5225225225225225, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.5858585858585859, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}2it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.170670073479414, 'eval_precision': 0.6868686868686869, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7311827956989247, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.2488934164866805, 'eval_precision': 0.6770833333333334, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7103825136612023, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.16956778499297798, 'eval_precision': 0.711340206185567, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.75, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}<00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2897078146634158, 'eval_precision': 0.6213592233009708, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6736842105263158, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2557001468958333, 'eval_precision': 0.5526315789473685, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6268656716417911, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.21501616889145225, 'eval_precision': 0.6565656565656566, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6989247311827956, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.18241213492001407, 'eval_precision': 0.6363636363636364, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6774193548387097, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.19693978276336566, 'eval_precision': 0.6875, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7213114754098361, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.19125102600082755, 'eval_precision': 0.696969696969697, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7419354838709677, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2618900923989713, 'eval_precision': 0.5961538461538461, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.649214659685864, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.24691224843263626, 'eval_precision': 0.6336633663366337, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6808510638297872, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.241260931128636, 'eval_precision': 0.5871559633027523, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6530612244897959, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.24855333811137825, 'eval_precision': 0.5794392523364486, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6391752577319586, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.23996647674357519, 'eval_precision': 0.6095238095238096, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6666666666666666, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.19909151248430135, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7692307692307692, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.1960862241103314, 'eval_precision': 0.7204301075268817, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7444444444444445, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.19719416597945383, 'eval_precision': 0.8160919540229885, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8160919540229885, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.4048707684469264, 'eval_precision': 0.7640449438202247, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7727272727272727, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.3275406977172679, 'eval_precision': 0.7472527472527473, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7640449438202248, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.19806873979723605, 'eval_precision': 0.7553191489361702, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7845303867403314, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.16032637388343574, 'eval_precision': 0.8, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8135593220338982, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.14488025226273749, 'eval_precision': 0.782608695652174, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8044692737430168, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.14678205251402687, 'eval_precision': 0.75, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7868852459016394, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}0:00,  9.63it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.14550899684581964, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.1604458145720855, 'eval_precision': 0.7956989247311828, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8222222222222222, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.19657002435269533, 'eval_precision': 0.7422680412371134, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.782608695652174, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.21506716043586493, 'eval_precision': 0.696969696969697, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7419354838709677, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.22604563716413395, 'eval_precision': 0.7319587628865979, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7717391304347826, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.22817060453235172, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.22726507539846352, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.22546392874937737, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.22491658143189852, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.49s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/14/2021 09:32:05 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.74it/s]
{'eval_loss': 0.2250613869910012, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/14/2021 09:32:06 - INFO - __main__ -   ***** Eval results *****
04/14/2021 09:32:06 - INFO - __main__ -     eval_loss = 0.2250613869910012
04/14/2021 09:32:06 - INFO - __main__ -     eval_precision = 0.7395833333333334
04/14/2021 09:32:06 - INFO - __main__ -     eval_recall = 0.8160919540229885
04/14/2021 09:32:06 - INFO - __main__ -     eval_f1 = 0.7759562841530055
04/14/2021 09:32:06 - INFO - __main__ -     epoch = 60.0
04/14/2021 09:32:06 - INFO - __main__ -     total_flos = 5255696336486400
