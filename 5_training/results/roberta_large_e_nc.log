/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 05:33:59 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 05:33:59 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-large-final-1', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_05-33-59_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=1, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 05:34:09 - INFO - filelock -   Lock 140673537653680 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:34:09 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 05:34:09 - INFO - filelock -   Lock 140673537653680 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:34:09 - INFO - filelock -   Lock 140673537653536 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 05:34:09 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 05:34:09 - INFO - filelock -   Lock 140673537653536 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  3.00it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:06, 13.33s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.71it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.4347907230257988, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.91it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.6125803329050541, 'eval_precision': 0.09230769230769231, 'eval_recall': 0.13793103448275862, 'eval_f1': 0.11059907834101382, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.3489929251372814, 'eval_precision': 0.3893805309734513, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.44000000000000006, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.22525595780462027, 'eval_precision': 0.514018691588785, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5670103092783505, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}63it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.18028817512094975, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.21483735647052526, 'eval_precision': 0.6082474226804123, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.6413043478260869, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.17752875189762563, 'eval_precision': 0.6391752577319587, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6739130434782609, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.19223932968452573, 'eval_precision': 0.5370370370370371, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.5948717948717949, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.12733144918456674, 'eval_precision': 0.6464646464646465, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6881720430107527, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14394807373173535, 'eval_precision': 0.5363636363636364, 'eval_recall': 0.6781609195402298, 'eval_f1': 0.5989847715736041, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14925158466212451, 'eval_precision': 0.68, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7272727272727274, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.13818810204975307, 'eval_precision': 0.6018518518518519, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6666666666666667, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12054556678049266, 'eval_precision': 0.6938775510204082, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7351351351351352, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.10062693379586563, 'eval_precision': 0.7684210526315789, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8021978021978021, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.09153589745983481, 'eval_precision': 0.6938775510204082, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7351351351351352, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.11961324542062357, 'eval_precision': 0.8, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8135593220338982, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}00:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12019171702559106, 'eval_precision': 0.7659574468085106, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7955801104972374, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.11508059775951551, 'eval_precision': 0.7448979591836735, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7891891891891891, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14530756953172386, 'eval_precision': 0.75, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.770949720670391, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}00:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.16291639106930234, 'eval_precision': 0.711340206185567, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.75, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14812364662066102, 'eval_precision': 0.7263157894736842, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7582417582417583, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1331619181437418, 'eval_precision': 0.8131868131868132, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8314606741573034, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.14094562944956124, 'eval_precision': 0.782608695652174, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8044692737430168, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14299927660249523, 'eval_precision': 0.7956989247311828, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8222222222222222, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1292048116119986, 'eval_precision': 0.8351648351648352, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.853932584269663, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12699749676539795, 'eval_precision': 0.7956989247311828, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8222222222222222, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13639266471000155, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13932714465408935, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13480095830163918, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.11947687297288212, 'eval_precision': 0.7578947368421053, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7912087912087912, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.11509486331669905, 'eval_precision': 0.7741935483870968, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7999999999999999, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12233814015053213, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.11929856543065398, 'eval_precision': 0.7934782608695652, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8156424581005586, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.12230326334065467, 'eval_precision': 0.7934782608695652, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8156424581005586, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.11760653804776666, 'eval_precision': 0.7849462365591398, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8111111111111111, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.12406004750664579, 'eval_precision': 0.7319587628865979, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7717391304347826, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12385057987194159, 'eval_precision': 0.7319587628865979, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7717391304347826, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:28<00:00, 13.47s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 05:47:41 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.72it/s]
{'eval_loss': 0.12387256396687008, 'eval_precision': 0.7319587628865979, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7717391304347826, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/18/2021 05:47:42 - INFO - __main__ -   ***** Eval results *****
04/18/2021 05:47:42 - INFO - __main__ -     eval_loss = 0.12387256396687008
04/18/2021 05:47:42 - INFO - __main__ -     eval_precision = 0.7319587628865979
04/18/2021 05:47:42 - INFO - __main__ -     eval_recall = 0.8160919540229885
04/18/2021 05:47:42 - INFO - __main__ -     eval_f1 = 0.7717391304347826
04/18/2021 05:47:42 - INFO - __main__ -     epoch = 60.0
04/18/2021 05:47:42 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 05:47:44 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 05:47:44 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-large-final-2', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_05-47-44_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=2, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 05:47:54 - INFO - filelock -   Lock 139849018792880 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:47:54 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 05:47:54 - INFO - filelock -   Lock 139849018792880 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 05:47:54 - INFO - filelock -   Lock 139849018792736 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 05:47:54 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 05:47:54 - INFO - filelock -   Lock 139849018792736 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:08, 13.37s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 1.100525677204132, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}███████████████████████| 8/8 [00:00<00:00,  9.63it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.637454379349947, 'eval_precision': 0.11464968152866242, 'eval_recall': 0.20689655172413793, 'eval_f1': 0.14754098360655737, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.40404754504561424, 'eval_precision': 0.25190839694656486, 'eval_recall': 0.3793103448275862, 'eval_f1': 0.30275229357798167, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.35367658734321594, 'eval_precision': 0.2926829268292683, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.3428571428571428, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.25624304357916117, 'eval_precision': 0.3220338983050847, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.37073170731707317, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.3204950448125601, 'eval_precision': 0.2366412213740458, 'eval_recall': 0.3563218390804598, 'eval_f1': 0.28440366972477066, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.26767460349947214, 'eval_precision': 0.29457364341085274, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.3518518518518519, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2850383040495217, 'eval_precision': 0.23880597014925373, 'eval_recall': 0.367816091954023, 'eval_f1': 0.28959276018099545, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.32032452896237373, 'eval_precision': 0.3170731707317073, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.37142857142857144, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.31062810542061925, 'eval_precision': 0.328, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.38679245283018865, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.3275775187648833, 'eval_precision': 0.33884297520661155, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.3942307692307692, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.30519867967814207, 'eval_precision': 0.2868217054263566, 'eval_recall': 0.42528735632183906, 'eval_f1': 0.3425925925925926, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.32837297674268484, 'eval_precision': 0.344, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.40566037735849053, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.42649554600939155, 'eval_precision': 0.3467741935483871, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.4075829383886256, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.38926533330231905, 'eval_precision': 0.4224137931034483, 'eval_recall': 0.5632183908045977, 'eval_f1': 0.48275862068965514, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.3566279043443501, 'eval_precision': 0.425, 'eval_recall': 0.5862068965517241, 'eval_f1': 0.4927536231884058, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}0:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.3091778592206538, 'eval_precision': 0.42016806722689076, 'eval_recall': 0.5747126436781609, 'eval_f1': 0.4854368932038835, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2580473590642214, 'eval_precision': 0.5327102803738317, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5876288659793815, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.24651617545168847, 'eval_precision': 0.62, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6631016042780749, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}0:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.23256271783611737, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6994535519125683, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2251902042189613, 'eval_precision': 0.6597938144329897, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6956521739130436, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2781935996026732, 'eval_precision': 0.6262626262626263, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6666666666666667, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2642434870940633, 'eval_precision': 0.6565656565656566, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6989247311827956, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.25035325913631823, 'eval_precision': 0.6701030927835051, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7065217391304347, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.24091891752323136, 'eval_precision': 0.6632653061224489, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7027027027027026, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2353091060940642, 'eval_precision': 0.7282608695652174, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7486033519553073, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2594113161612768, 'eval_precision': 0.7472527472527473, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7640449438202248, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2511401954543544, 'eval_precision': 0.7444444444444445, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7570621468926554, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2625653925279039, 'eval_precision': 0.7391304347826086, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7597765363128491, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2626041541589075, 'eval_precision': 0.7777777777777778, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7909604519774011, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2598344030120643, 'eval_precision': 0.7666666666666667, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7796610169491527, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2504390616159071, 'eval_precision': 0.7865168539325843, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7954545454545455, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.24737952281429898, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2354384887876222, 'eval_precision': 0.7777777777777778, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7909604519774011, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.22463008268823614, 'eval_precision': 0.7865168539325843, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7954545454545455, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.22070587321650237, 'eval_precision': 0.8068181818181818, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8114285714285714, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.22014435258461162, 'eval_precision': 0.8068181818181818, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8114285714285714, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.48s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 06:01:27 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.70it/s]
{'eval_loss': 0.21990063192060916, 'eval_precision': 0.8068181818181818, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8114285714285714, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/18/2021 06:01:28 - INFO - __main__ -   ***** Eval results *****
04/18/2021 06:01:28 - INFO - __main__ -     eval_loss = 0.21990063192060916
04/18/2021 06:01:28 - INFO - __main__ -     eval_precision = 0.8068181818181818
04/18/2021 06:01:28 - INFO - __main__ -     eval_recall = 0.8160919540229885
04/18/2021 06:01:28 - INFO - __main__ -     eval_f1 = 0.8114285714285714
04/18/2021 06:01:28 - INFO - __main__ -     epoch = 60.0
04/18/2021 06:01:28 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 06:01:29 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 06:01:29 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-large-final-3', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_06-01-29_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=3, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 06:01:39 - INFO - filelock -   Lock 140486647843760 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 06:01:39 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 06:01:39 - INFO - filelock -   Lock 140486647843760 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 06:01:39 - INFO - filelock -   Lock 140486647843616 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 06:01:39 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 06:01:39 - INFO - filelock -   Lock 140486647843616 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.38s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.1120462864637375, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.6983373686671257, 'eval_precision': 0.10569105691056911, 'eval_recall': 0.14942528735632185, 'eval_f1': 0.12380952380952381, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.40263839066028595, 'eval_precision': 0.2595419847328244, 'eval_recall': 0.39080459770114945, 'eval_f1': 0.3119266055045872, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.3440114036202431, 'eval_precision': 0.25396825396825395, 'eval_recall': 0.367816091954023, 'eval_f1': 0.3004694835680751, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}3it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.3284836206585169, 'eval_precision': 0.25384615384615383, 'eval_recall': 0.3793103448275862, 'eval_f1': 0.30414746543778803, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2860822081565857, 'eval_precision': 0.2753623188405797, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.3377777777777778, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.21396004687994719, 'eval_precision': 0.5327102803738317, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5876288659793815, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.18663891241885722, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1620205449871719, 'eval_precision': 0.6153846153846154, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6701570680628273, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.15795278828591108, 'eval_precision': 0.6057692307692307, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6596858638743456, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.16701993334572762, 'eval_precision': 0.68, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7272727272727274, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}00:00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.12454011739464477, 'eval_precision': 0.7340425531914894, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7624309392265194, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.18658425891771913, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15922473307000473, 'eval_precision': 0.71875, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7540983606557378, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}0,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1611540779704228, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1469421464134939, 'eval_precision': 0.8111111111111111, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8248587570621468, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1270319304894656, 'eval_precision': 0.7708333333333334, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8087431693989071, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12903009803267196, 'eval_precision': 0.7802197802197802, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.797752808988764, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.0939469876466319, 'eval_precision': 0.8172043010752689, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8444444444444446, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.10852008308575023, 'eval_precision': 0.782608695652174, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8044692737430168, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1194147834321484, 'eval_precision': 0.7244897959183674, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7675675675675676, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.10153994796564803, 'eval_precision': 0.78125, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8196721311475409, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}0,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.09648847568314523, 'eval_precision': 0.7244897959183674, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7675675675675676, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.21259637860930525, 'eval_precision': 0.8235294117647058, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.813953488372093, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.16213754389173118, 'eval_precision': 0.7608695652173914, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.782122905027933, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.16392660152632743, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.17482059309259057, 'eval_precision': 0.797752808988764, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8068181818181818, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.16862848529126495, 'eval_precision': 0.7472527472527473, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7640449438202248, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14847155778261367, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13955854514642851, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14640983170829713, 'eval_precision': 0.7446808510638298, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7734806629834253, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1597538786008954, 'eval_precision': 0.8, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8135593220338982, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}<00:00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.16205735900439322, 'eval_precision': 0.797752808988764, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8068181818181818, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.14891004282981157, 'eval_precision': 0.7865168539325843, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7954545454545455, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13570256833918393, 'eval_precision': 0.7888888888888889, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8022598870056497, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1329836328222882, 'eval_precision': 0.7553191489361702, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7845303867403314, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.13268579014402349, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.49s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 06:15:11 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.71it/s]
{'eval_loss': 0.13259538715647068, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/18/2021 06:15:12 - INFO - __main__ -   ***** Eval results *****
04/18/2021 06:15:12 - INFO - __main__ -     eval_loss = 0.13259538715647068
04/18/2021 06:15:12 - INFO - __main__ -     eval_precision = 0.7473684210526316
04/18/2021 06:15:12 - INFO - __main__ -     eval_recall = 0.8160919540229885
04/18/2021 06:15:12 - INFO - __main__ -     eval_f1 = 0.7802197802197802
04/18/2021 06:15:12 - INFO - __main__ -     epoch = 60.0
04/18/2021 06:15:12 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 06:15:14 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 06:15:14 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-large-final-4', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_06-15-14_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=4, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 06:15:24 - INFO - filelock -   Lock 139906588060592 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 06:15:24 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 06:15:24 - INFO - filelock -   Lock 139906588060592 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 06:15:24 - INFO - filelock -   Lock 139906588060448 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 06:15:24 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 06:15:24 - INFO - filelock -   Lock 139906588060448 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.38s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 1.130751483142376, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}███████████████████████| 8/8 [00:00<00:00,  9.63it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.5377907603979111, 'eval_precision': 0.15827338129496402, 'eval_recall': 0.25287356321839083, 'eval_f1': 0.19469026548672566, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.37680643424391747, 'eval_precision': 0.2845528455284553, 'eval_recall': 0.40229885057471265, 'eval_f1': 0.33333333333333337, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.296541765332222, 'eval_precision': 0.3089430894308943, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.3619047619047619, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2688462119549513, 'eval_precision': 0.3728813559322034, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.4292682926829269, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.22908472269773483, 'eval_precision': 0.35294117647058826, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.4077669902912622, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.26962022949010134, 'eval_precision': 0.30327868852459017, 'eval_recall': 0.42528735632183906, 'eval_f1': 0.35406698564593303, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2400843882933259, 'eval_precision': 0.3252032520325203, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.38095238095238093, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2488997345790267, 'eval_precision': 0.23529411764705882, 'eval_recall': 0.367816091954023, 'eval_f1': 0.28699551569506726, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2443146100267768, 'eval_precision': 0.3387096774193548, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.39810426540284355, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.23139570141211152, 'eval_precision': 0.3114754098360656, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.36363636363636365, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.24092962173745036, 'eval_precision': 0.3644067796610169, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.4195121951219512, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.25017794873565435, 'eval_precision': 0.2878787878787879, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.34703196347031967, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2849855897948146, 'eval_precision': 0.2748091603053435, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.33027522935779824, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.25139622017741203, 'eval_precision': 0.28125, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.33488372093023255, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.25662253657355905, 'eval_precision': 0.3445378151260504, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.39805825242718446, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.28430915297940373, 'eval_precision': 0.3252032520325203, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.38095238095238093, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.3306600688956678, 'eval_precision': 0.3728813559322034, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.4292682926829269, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.25735463481396437, 'eval_precision': 0.29411764705882354, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.3587443946188341, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.29913498274981976, 'eval_precision': 0.296875, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.35348837209302325, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2515914929099381, 'eval_precision': 0.28125, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.33488372093023255, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168},  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2750200773589313, 'eval_precision': 0.26865671641791045, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.3257918552036199, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.23824923299252987, 'eval_precision': 0.31746031746031744, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.3755868544600939, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2614382584579289, 'eval_precision': 0.3333333333333333, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.39047619047619053, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.26117248833179474, 'eval_precision': 0.28346456692913385, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.3364485981308411, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2557213148102164, 'eval_precision': 0.2900763358778626, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.3486238532110092, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.25237845443189144, 'eval_precision': 0.3023255813953488, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.36111111111111105, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.26114931562915444, 'eval_precision': 0.30708661417322836, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.36448598130841126, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.59it/s]
{'eval_loss': 0.2763338126242161, 'eval_precision': 0.2727272727272727, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.32876712328767127, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.30028363270685077, 'eval_precision': 0.27906976744186046, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.3333333333333333, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2997898585163057, 'eval_precision': 0.28125, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.33488372093023255, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248},  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.3006926141679287, 'eval_precision': 0.28125, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.33488372093023255, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256},  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.29527331702411175, 'eval_precision': 0.2748091603053435, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.33027522935779824, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2898743120022118, 'eval_precision': 0.2748091603053435, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.33027522935779824, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.28402211610227823, 'eval_precision': 0.2803030303030303, 'eval_recall': 0.42528735632183906, 'eval_f1': 0.3378995433789954, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2813293021172285, 'eval_precision': 0.2727272727272727, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.32876712328767127, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.28004965698346496, 'eval_precision': 0.2727272727272727, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.32876712328767127, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.49s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 06:28:57 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.72it/s]
{'eval_loss': 0.2795754121616483, 'eval_precision': 0.2727272727272727, 'eval_recall': 0.41379310344827586, 'eval_f1': 0.32876712328767127, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/18/2021 06:28:58 - INFO - __main__ -   ***** Eval results *****
04/18/2021 06:28:58 - INFO - __main__ -     eval_loss = 0.2795754121616483
04/18/2021 06:28:58 - INFO - __main__ -     eval_precision = 0.2727272727272727
04/18/2021 06:28:58 - INFO - __main__ -     eval_recall = 0.41379310344827586
04/18/2021 06:28:58 - INFO - __main__ -     eval_f1 = 0.32876712328767127
04/18/2021 06:28:58 - INFO - __main__ -     epoch = 60.0
04/18/2021 06:28:58 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 06:29:00 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 06:29:00 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-large-final-5', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_06-29-00_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=5, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 06:29:09 - INFO - filelock -   Lock 139843423443792 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 06:29:09 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 06:29:09 - INFO - filelock -   Lock 139843423443792 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 06:29:09 - INFO - filelock -   Lock 139843423443648 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 06:29:09 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 06:29:09 - INFO - filelock -   Lock 139843423443648 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.38s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.553676038980484, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.6919045671820641, 'eval_precision': 0.14736842105263157, 'eval_recall': 0.16091954022988506, 'eval_f1': 0.15384615384615383, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.4820445291697979, 'eval_precision': 0.20408163265306123, 'eval_recall': 0.3448275862068966, 'eval_f1': 0.25641025641025644, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.34589494951069355, 'eval_precision': 0.2692307692307692, 'eval_recall': 0.40229885057471265, 'eval_f1': 0.3225806451612903, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.29568331129848957, 'eval_precision': 0.2692307692307692, 'eval_recall': 0.40229885057471265, 'eval_f1': 0.3225806451612903, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.30993382539600134, 'eval_precision': 0.296875, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.35348837209302325, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.26205969229340553, 'eval_precision': 0.21428571428571427, 'eval_recall': 0.3448275862068966, 'eval_f1': 0.2643171806167401, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2490323381498456, 'eval_precision': 0.296875, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.35348837209302325, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}0,  9.59it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.25149764120578766, 'eval_precision': 0.2824427480916031, 'eval_recall': 0.42528735632183906, 'eval_f1': 0.3394495412844037, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.25085492338985205, 'eval_precision': 0.2595419847328244, 'eval_recall': 0.39080459770114945, 'eval_f1': 0.3119266055045872, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2876313952729106, 'eval_precision': 0.3305084745762712, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.3804878048780488, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2026592125184834, 'eval_precision': 0.31496062992125984, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.37383177570093457, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.23718858417123556, 'eval_precision': 0.3559322033898305, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.40975609756097564, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.21688430663198233, 'eval_precision': 0.3821138211382114, 'eval_recall': 0.5402298850574713, 'eval_f1': 0.44761904761904764, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2782232481986284, 'eval_precision': 0.3389830508474576, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.39024390243902435, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2488907389342785, 'eval_precision': 0.3170731707317073, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.37142857142857144, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2026223400607705, 'eval_precision': 0.3203125, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.38139534883720927, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136} 9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.19488305691629648, 'eval_precision': 0.328, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.38679245283018865, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}0,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20466897124424577, 'eval_precision': 0.3953488372093023, 'eval_recall': 0.5862068965517241, 'eval_f1': 0.4722222222222222, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2544993623159826, 'eval_precision': 0.38333333333333336, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4444444444444445, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.24029824743047357, 'eval_precision': 0.37815126050420167, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.4368932038834952, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.23116220766678452, 'eval_precision': 0.38333333333333336, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4444444444444445, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20947878854349256, 'eval_precision': 0.3387096774193548, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.39810426540284355, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20882373861968517, 'eval_precision': 0.3548387096774194, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.4170616113744076, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.22394387610256672, 'eval_precision': 0.3492063492063492, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.41314553990610325, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1831426857970655, 'eval_precision': 0.34146341463414637, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.4000000000000001, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.19132689479738474, 'eval_precision': 0.36666666666666664, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.4251207729468599, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20858775218948722, 'eval_precision': 0.34710743801652894, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.40384615384615385, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.23316779686138034, 'eval_precision': 0.36134453781512604, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.4174757281553398, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.22028137696906924, 'eval_precision': 0.39166666666666666, 'eval_recall': 0.5402298850574713, 'eval_f1': 0.4541062801932367, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.18873341009020805, 'eval_precision': 0.38016528925619836, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4423076923076923, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.19010117556899786, 'eval_precision': 0.38333333333333336, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4444444444444445, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.18814310617744923, 'eval_precision': 0.38333333333333336, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4444444444444445, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.18470400711521506, 'eval_precision': 0.371900826446281, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.43269230769230765, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.18424410931766033, 'eval_precision': 0.38333333333333336, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4444444444444445, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.18417617119848728, 'eval_precision': 0.38333333333333336, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4444444444444445, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.18502353131771088, 'eval_precision': 0.38333333333333336, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4444444444444445, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.48s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 06:42:42 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.71it/s]
{'eval_loss': 0.18503860291093588, 'eval_precision': 0.38333333333333336, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4444444444444445, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/18/2021 06:42:43 - INFO - __main__ -   ***** Eval results *****
04/18/2021 06:42:43 - INFO - __main__ -     eval_loss = 0.18503860291093588
04/18/2021 06:42:43 - INFO - __main__ -     eval_precision = 0.38333333333333336
04/18/2021 06:42:43 - INFO - __main__ -     eval_recall = 0.5287356321839081
04/18/2021 06:42:43 - INFO - __main__ -     eval_f1 = 0.4444444444444445
04/18/2021 06:42:43 - INFO - __main__ -     epoch = 60.0
04/18/2021 06:42:43 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 06:42:44 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 06:42:44 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-large-final-6', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_06-42-44_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=6, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 06:42:54 - INFO - filelock -   Lock 139823207000912 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 06:42:54 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 06:42:54 - INFO - filelock -   Lock 139823207000912 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 06:42:54 - INFO - filelock -   Lock 139823207000768 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 06:42:54 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 06:42:54 - INFO - filelock -   Lock 139823207000768 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.38s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.3562312722206116, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.701834861189127, 'eval_precision': 0.09848484848484848, 'eval_recall': 0.14942528735632185, 'eval_f1': 0.11872146118721462, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.4737740829586983, 'eval_precision': 0.17647058823529413, 'eval_recall': 0.27586206896551724, 'eval_f1': 0.21524663677130043, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.29284544847905636, 'eval_precision': 0.24812030075187969, 'eval_recall': 0.3793103448275862, 'eval_f1': 0.3, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}0<00:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2843917552381754, 'eval_precision': 0.2773722627737226, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.3392857142857143, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.4294382845982909, 'eval_precision': 0.265625, 'eval_recall': 0.39080459770114945, 'eval_f1': 0.31627906976744186, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.34595986641943455, 'eval_precision': 0.3023255813953488, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.36111111111111105, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2848486742004752, 'eval_precision': 0.3467741935483871, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.4075829383886256, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.24575255159288645, 'eval_precision': 0.31297709923664124, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.3761467889908257, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.27484838478267193, 'eval_precision': 0.2824427480916031, 'eval_recall': 0.42528735632183906, 'eval_f1': 0.3394495412844037, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.255868311971426, 'eval_precision': 0.3412698412698413, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.4037558685446009, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.37489217426627874, 'eval_precision': 0.32558139534883723, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.38888888888888895, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.34385001938790083, 'eval_precision': 0.3253968253968254, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.3849765258215963, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.188030157238245, 'eval_precision': 0.36220472440944884, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4299065420560748, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.271514349617064, 'eval_precision': 0.30952380952380953, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.3661971830985915, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2236836994998157, 'eval_precision': 0.2932330827067669, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.35454545454545455, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.21561792073771358, 'eval_precision': 0.32061068702290074, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.3853211009174312, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.23203897243365645, 'eval_precision': 0.352, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.41509433962264153, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.22941906237974763, 'eval_precision': 0.2878787878787879, 'eval_recall': 0.4367816091954023, 'eval_f1': 0.34703196347031967, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.28804229013621807, 'eval_precision': 0.3488372093023256, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.41666666666666663, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2996328226290643, 'eval_precision': 0.344, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.40566037735849053, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.28803264256566763, 'eval_precision': 0.3333333333333333, 'eval_recall': 0.4827586206896552, 'eval_f1': 0.39436619718309857, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.26261816872283816, 'eval_precision': 0.344, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.40566037735849053, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2420359323732555, 'eval_precision': 0.30952380952380953, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.3661971830985915, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.295237738173455, 'eval_precision': 0.32231404958677684, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.37499999999999994, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.32807702338322997, 'eval_precision': 0.3333333333333333, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.39047619047619053, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2990391720086336, 'eval_precision': 0.3467741935483871, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.4075829383886256, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.26611379673704505, 'eval_precision': 0.3333333333333333, 'eval_recall': 0.45977011494252873, 'eval_f1': 0.38647342995169076, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.25404897006228566, 'eval_precision': 0.3360655737704918, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.39234449760765544, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.257843304425478, 'eval_precision': 0.3492063492063492, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.41314553990610325, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2605737382546067, 'eval_precision': 0.33064516129032256, 'eval_recall': 0.47126436781609193, 'eval_f1': 0.3886255924170616, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2597060101106763, 'eval_precision': 0.371900826446281, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.43269230769230765, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2597941136918962, 'eval_precision': 0.371900826446281, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.43269230769230765, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.26034177001565695, 'eval_precision': 0.36363636363636365, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.42307692307692313, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.26057072449475527, 'eval_precision': 0.36363636363636365, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.42307692307692313, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.26190571626648307, 'eval_precision': 0.36363636363636365, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.42307692307692313, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2626051879487932, 'eval_precision': 0.36363636363636365, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.42307692307692313, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:28<00:00, 13.48s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 06:56:27 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.71it/s]
{'eval_loss': 0.26242919731885195, 'eval_precision': 0.36363636363636365, 'eval_recall': 0.5057471264367817, 'eval_f1': 0.42307692307692313, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/18/2021 06:56:27 - INFO - __main__ -   ***** Eval results *****
04/18/2021 06:56:27 - INFO - __main__ -     eval_loss = 0.26242919731885195
04/18/2021 06:56:27 - INFO - __main__ -     eval_precision = 0.36363636363636365
04/18/2021 06:56:27 - INFO - __main__ -     eval_recall = 0.5057471264367817
04/18/2021 06:56:27 - INFO - __main__ -     eval_f1 = 0.42307692307692313
04/18/2021 06:56:27 - INFO - __main__ -     epoch = 60.0
04/18/2021 06:56:27 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 06:56:29 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 06:56:29 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-large-final-7', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_06-56-29_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=7, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 06:56:39 - INFO - filelock -   Lock 140162710440784 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 06:56:39 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 06:56:39 - INFO - filelock -   Lock 140162710440784 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 06:56:39 - INFO - filelock -   Lock 140162710440640 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 06:56:39 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 06:56:39 - INFO - filelock -   Lock 140162710440640 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.38s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 1.1334445029497147, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}██████████████████████| 8/8 [00:00<00:00,  9.64it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.7177485600113869, 'eval_precision': 0.06862745098039216, 'eval_recall': 0.08045977011494253, 'eval_f1': 0.07407407407407408, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.5181787088513374, 'eval_precision': 0.10869565217391304, 'eval_recall': 0.1724137931034483, 'eval_f1': 0.13333333333333333, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.3664436209946871, 'eval_precision': 0.2894736842105263, 'eval_recall': 0.3793103448275862, 'eval_f1': 0.3283582089552239, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.3213327191770077, 'eval_precision': 0.3805309734513274, 'eval_recall': 0.4942528735632184, 'eval_f1': 0.43, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}00<00:00,  9.59it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2804012540727854, 'eval_precision': 0.5294117647058824, 'eval_recall': 0.6206896551724138, 'eval_f1': 0.5714285714285715, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}1it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.24836652912199497, 'eval_precision': 0.5094339622641509, 'eval_recall': 0.6206896551724138, 'eval_f1': 0.5595854922279793, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.87it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.23925218894146383, 'eval_precision': 0.6060606060606061, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6451612903225807, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.27295182878151536, 'eval_precision': 0.5045871559633027, 'eval_recall': 0.632183908045977, 'eval_f1': 0.5612244897959184, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.29732821322977543, 'eval_precision': 0.6086956521739131, 'eval_recall': 0.6436781609195402, 'eval_f1': 0.6256983240223463, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.2949439766816795, 'eval_precision': 0.631578947368421, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6593406593406593, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.22032179962843657, 'eval_precision': 0.5098039215686274, 'eval_recall': 0.5977011494252874, 'eval_f1': 0.5502645502645502, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.24240867979824543, 'eval_precision': 0.5980392156862745, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6455026455026455, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20868133625481278, 'eval_precision': 0.6770833333333334, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7103825136612023, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.19608704780694097, 'eval_precision': 0.6836734693877551, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7243243243243244, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20774106623139232, 'eval_precision': 0.6161616161616161, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6559139784946237, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.24918090645223856, 'eval_precision': 0.6274509803921569, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6772486772486773, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.17299042965169065, 'eval_precision': 0.6767676767676768, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7204301075268816, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.17200612486340106, 'eval_precision': 0.71875, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7540983606557378, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}0,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.16676243749679998, 'eval_precision': 0.6464646464646465, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6881720430107527, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.20777366438414901, 'eval_precision': 0.7222222222222222, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7344632768361581, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2118849488979322, 'eval_precision': 0.7553191489361702, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7845303867403314, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14251640127622522, 'eval_precision': 0.8068181818181818, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8114285714285714, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.12815577883156948, 'eval_precision': 0.7526881720430108, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7777777777777778, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.11921207146951929, 'eval_precision': 0.7472527472527473, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7640449438202248, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.13869832979980856, 'eval_precision': 0.6770833333333334, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7103825136612023, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1366844403091818, 'eval_precision': 0.7096774193548387, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7333333333333333, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14015908047440462, 'eval_precision': 0.7555555555555555, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.768361581920904, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14191594999283552, 'eval_precision': 0.7582417582417582, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7752808988764045, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14450390002457425, 'eval_precision': 0.7777777777777778, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7909604519774011, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15026824080268852, 'eval_precision': 0.7888888888888889, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8022598870056497, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1518897083005868, 'eval_precision': 0.7888888888888889, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8022598870056497, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15207238786388189, 'eval_precision': 0.7888888888888889, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.8022598870056497, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1496169258170994, 'eval_precision': 0.7777777777777778, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7909604519774011, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14891656005056575, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7865168539325844, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1482778259087354, 'eval_precision': 0.7582417582417582, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7752808988764045, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1491104343876941, 'eval_precision': 0.7582417582417582, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7752808988764045, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.49s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 07:10:12 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.70it/s]
{'eval_loss': 0.14904403041873593, 'eval_precision': 0.7582417582417582, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7752808988764045, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/18/2021 07:10:13 - INFO - __main__ -   ***** Eval results *****
04/18/2021 07:10:13 - INFO - __main__ -     eval_loss = 0.14904403041873593
04/18/2021 07:10:13 - INFO - __main__ -     eval_precision = 0.7582417582417582
04/18/2021 07:10:13 - INFO - __main__ -     eval_recall = 0.7931034482758621
04/18/2021 07:10:13 - INFO - __main__ -     eval_f1 = 0.7752808988764045
04/18/2021 07:10:13 - INFO - __main__ -     epoch = 60.0
04/18/2021 07:10:13 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 07:10:15 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 07:10:15 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-large-final-8', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_07-10-15_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=8, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 07:10:24 - INFO - filelock -   Lock 140392854571952 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 07:10:24 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 07:10:24 - INFO - filelock -   Lock 140392854571952 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 07:10:24 - INFO - filelock -   Lock 140392854571808 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 07:10:24 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 07:10:24 - INFO - filelock -   Lock 140392854571808 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.38s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.1110162138938904, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.5589794851839542, 'eval_precision': 0.1527777777777778, 'eval_recall': 0.25287356321839083, 'eval_f1': 0.1904761904761905, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.39240604266524315, 'eval_precision': 0.3813559322033898, 'eval_recall': 0.5172413793103449, 'eval_f1': 0.43902439024390244, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.25698063522577286, 'eval_precision': 0.4107142857142857, 'eval_recall': 0.5287356321839081, 'eval_f1': 0.4623115577889447, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.19976370688527822, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.24942989426199347, 'eval_precision': 0.6262626262626263, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6666666666666667, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2065741354599595, 'eval_precision': 0.5480769230769231, 'eval_recall': 0.6551724137931034, 'eval_f1': 0.5968586387434556, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1961151584982872, 'eval_precision': 0.5754716981132075, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6321243523316061, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1260710001224652, 'eval_precision': 0.696969696969697, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7419354838709677, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.19078311417251825, 'eval_precision': 0.6979166666666666, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7322404371584699, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.25757321511628106, 'eval_precision': 0.6060606060606061, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.6451612903225807, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20051510474877432, 'eval_precision': 0.7204301075268817, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7444444444444445, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.15626166271977127, 'eval_precision': 0.7340425531914894, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7624309392265194, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14142629137495533, 'eval_precision': 0.71, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7593582887700535, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}0:00,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.15080096648307517, 'eval_precision': 0.6372549019607843, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.6878306878306877, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15565689880168065, 'eval_precision': 0.6767676767676768, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7204301075268816, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.24109798960125772, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7096774193548386, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2328057197155431, 'eval_precision': 0.6842105263157895, 'eval_recall': 0.7471264367816092, 'eval_f1': 0.7142857142857142, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20617228592163883, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.17206275028001983, 'eval_precision': 0.7608695652173914, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.782122905027933, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.17916231046547182, 'eval_precision': 0.7954545454545454, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7999999999999999, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.16334341080801096, 'eval_precision': 0.7802197802197802, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.797752808988764, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.1428242488473188, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15164621005533263, 'eval_precision': 0.6979166666666666, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7322404371584699, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1561129780311603, 'eval_precision': 0.723404255319149, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7513812154696133, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.13937960598559584, 'eval_precision': 0.7040816326530612, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7459459459459459, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13048876624088734, 'eval_precision': 0.7934782608695652, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8156424581005586, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.13103805070204544, 'eval_precision': 0.8111111111111111, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8248587570621468, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.12802859615476336, 'eval_precision': 0.8111111111111111, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.8248587570621468, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12155247246118961, 'eval_precision': 0.8444444444444444, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8587570621468928, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.12527822030097013, 'eval_precision': 0.8444444444444444, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8587570621468928, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1279644568785443, 'eval_precision': 0.8241758241758241, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8426966292134831, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.13463939649955137, 'eval_precision': 0.782608695652174, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8044692737430168, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.14034282963257283, 'eval_precision': 0.782608695652174, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.8044692737430168, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.14279167525637604, 'eval_precision': 0.7802197802197802, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.797752808988764, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.14342621954529022, 'eval_precision': 0.7608695652173914, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.782122905027933, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.14353063017733803, 'eval_precision': 0.7526881720430108, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7777777777777778, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.50s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 07:23:58 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.70it/s]
{'eval_loss': 0.14356046777356823, 'eval_precision': 0.7526881720430108, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7777777777777778, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/18/2021 07:23:59 - INFO - __main__ -   ***** Eval results *****
04/18/2021 07:23:59 - INFO - __main__ -     eval_loss = 0.14356046777356823
04/18/2021 07:23:59 - INFO - __main__ -     eval_precision = 0.7526881720430108
04/18/2021 07:23:59 - INFO - __main__ -     eval_recall = 0.8045977011494253
04/18/2021 07:23:59 - INFO - __main__ -     eval_f1 = 0.7777777777777778
04/18/2021 07:23:59 - INFO - __main__ -     epoch = 60.0
04/18/2021 07:23:59 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 07:24:00 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 07:24:00 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-large-final-9', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_07-24-00_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=9, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 07:24:10 - INFO - filelock -   Lock 140034673171280 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 07:24:10 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 07:24:10 - INFO - filelock -   Lock 140034673171280 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 07:24:10 - INFO - filelock -   Lock 140034673171136 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 07:24:10 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 07:24:10 - INFO - filelock -   Lock 140034673171136 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.38s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
/home/yoonsik/.local/lib/python3.8/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
{'eval_loss': 1.0918360352516174, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.7191448360681534, 'eval_precision': 0.09473684210526316, 'eval_recall': 0.10344827586206896, 'eval_f1': 0.0989010989010989, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.5149405561387539, 'eval_precision': 0.09154929577464789, 'eval_recall': 0.14942528735632185, 'eval_f1': 0.11353711790393013, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.3792172558605671, 'eval_precision': 0.21374045801526717, 'eval_recall': 0.3218390804597701, 'eval_f1': 0.25688073394495414, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.4269186984747648, 'eval_precision': 0.24806201550387597, 'eval_recall': 0.367816091954023, 'eval_f1': 0.29629629629629634, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2298025730997324, 'eval_precision': 0.4485981308411215, 'eval_recall': 0.5517241379310345, 'eval_f1': 0.4948453608247423, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}0it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.2138389484025538, 'eval_precision': 0.6764705882352942, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7301587301587301, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.23362617986276746, 'eval_precision': 0.6057692307692307, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6596858638743456, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.24390505952760577, 'eval_precision': 0.580952380952381, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6354166666666667, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.22210498806089163, 'eval_precision': 0.5263157894736842, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.5970149253731344, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.17142773885279894, 'eval_precision': 0.6057692307692307, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.6596858638743456, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.27701935241930187, 'eval_precision': 0.5918367346938775, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6270270270270271, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1845513327716617, 'eval_precision': 0.7752808988764045, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7840909090909092, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.12870380318781827, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.13573309801722644, 'eval_precision': 0.7171717171717171, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7634408602150538, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.14617600917699747, 'eval_precision': 0.7448979591836735, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7891891891891891, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15257168337120675, 'eval_precision': 0.7802197802197802, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.797752808988764, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.15940962624154054, 'eval_precision': 0.7127659574468085, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7403314917127071, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1717778782476671, 'eval_precision': 0.6875, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7213114754098361, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.18846461197244935, 'eval_precision': 0.7954545454545454, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7999999999999999, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.2620387346978532, 'eval_precision': 0.7096774193548387, 'eval_recall': 0.7586206896551724, 'eval_f1': 0.7333333333333333, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1671141047590936, 'eval_precision': 0.7634408602150538, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7888888888888889, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.16654576671498944, 'eval_precision': 0.71, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7593582887700535, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}0:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.15717919768576394, 'eval_precision': 0.6862745098039216, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7407407407407408, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.16276251041927026, 'eval_precision': 0.7604166666666666, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7978142076502732, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.16018172851909185, 'eval_precision': 0.7525773195876289, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7934782608695652, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.16159129633160774, 'eval_precision': 0.7473684210526316, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7802197802197802, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.16678952794609359, 'eval_precision': 0.75, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7868852459016394, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}0:00,  9.59it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.1721870569344901, 'eval_precision': 0.7525773195876289, 'eval_recall': 0.8390804597701149, 'eval_f1': 0.7934782608695652, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.17623853294571745, 'eval_precision': 0.78125, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8196721311475409, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}0,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.60it/s]
{'eval_loss': 0.17527161518592038, 'eval_precision': 0.78125, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8196721311475409, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}0,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.17093468158054748, 'eval_precision': 0.78125, 'eval_recall': 0.8620689655172413, 'eval_f1': 0.8196721311475409, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}0,  9.60it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.17841568932090013, 'eval_precision': 0.7872340425531915, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8176795580110497, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1946213111968973, 'eval_precision': 0.7659574468085106, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7955801104972374, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20145429926742509, 'eval_precision': 0.7659574468085106, 'eval_recall': 0.8275862068965517, 'eval_f1': 0.7955801104972374, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20277316293504555, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.20226105861365795, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:29<00:00, 13.49s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 07:37:43 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.69it/s]
{'eval_loss': 0.20212832383094792, 'eval_precision': 0.7395833333333334, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7759562841530055, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/18/2021 07:37:44 - INFO - __main__ -   ***** Eval results *****
04/18/2021 07:37:44 - INFO - __main__ -     eval_loss = 0.20212832383094792
04/18/2021 07:37:44 - INFO - __main__ -     eval_precision = 0.7395833333333334
04/18/2021 07:37:44 - INFO - __main__ -     eval_recall = 0.8160919540229885
04/18/2021 07:37:44 - INFO - __main__ -     eval_f1 = 0.7759562841530055
04/18/2021 07:37:44 - INFO - __main__ -     epoch = 60.0
04/18/2021 07:37:44 - INFO - __main__ -     total_flos = 5255696336486400
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/training_args.py:330: FutureWarning: The `evaluate_during_training` argument is deprecated in favor of `evaluation_strategy` (which has more options)
  warnings.warn(
04/18/2021 07:37:46 - WARNING - __main__ -   Process rank: -1, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
04/18/2021 07:37:46 - INFO - __main__ -   Training/evaluation parameters TrainingArguments(output_dir='./5_training/saved_models_e_nc/roberta-large-final-10', overwrite_output_dir=False, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=True, evaluation_strategy=<EvaluationStrategy.STEPS: 'steps'>, prediction_loss_only=False, per_device_train_batch_size=2, per_device_eval_batch_size=2, per_gpu_train_batch_size=None, per_gpu_eval_batch_size=None, gradient_accumulation_steps=8, learning_rate=5e-05, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=60.0, max_steps=-1, warmup_steps=10, logging_dir='runs/Apr18_07-37-46_beast', logging_first_step=False, logging_steps=500, save_steps=1750, save_total_limit=None, no_cuda=False, seed=10, fp16=False, fp16_opt_level='O1', local_rank=-1, tpu_num_cores=None, tpu_metrics_debug=False, debug=False, dataloader_drop_last=False, eval_steps=8, dataloader_num_workers=0, past_index=-1, run_name=None, disable_tqdm=False, remove_unused_columns=True, label_names=None, load_best_model_at_end=False, metric_for_best_model=None, greater_is_better=False)
Some weights of the model checkpoint at roberta-large were not used when initializing RobertaForJointEntityRelationClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).
- This IS NOT expected if you are initializing RobertaForJointEntityRelationClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForJointEntityRelationClassification were not initialized from the model checkpoint at roberta-large and are newly initialized: ['token_classifier.weight', 'token_classifier.bias', 'relation_classifier.dense.weight', 'relation_classifier.dense.bias', 'relation_classifier.out_proj.weight', 'relation_classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/18/2021 07:37:55 - INFO - filelock -   Lock 140227320232784 acquired on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 07:37:55 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512
04/18/2021 07:37:55 - INFO - filelock -   Lock 140227320232784 released on ./3_iob_data/no_context/train_entity/cached_train_RobertaTokenizer_512.lock
04/18/2021 07:37:55 - INFO - filelock -   Lock 140227320232640 acquired on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
04/18/2021 07:37:55 - INFO - utils_ner -   Loading features from cached file ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512
04/18/2021 07:37:55 - INFO - filelock -   Lock 140227320232640 released on ./3_iob_data/no_context/train_entity/cached_dev_RobertaTokenizer_512.lock
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.99it/s]
Epoch:   2%|▉                                                        | 1/60 [00:13<13:09, 13.38s/it/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1356: FutureWarning: The `_prediction_loop` method is deprecated and won't be called in a future version, define `prediction_loop` in your subclass.
  warnings.warn(
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 1.0870216190814972, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'epoch': 1.6, 'total_flos': 140151902306304, 'step': 8}██████████████████████| 8/8 [00:00<00:00,  9.63it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.6934773065149784, 'eval_precision': 0.16853932584269662, 'eval_recall': 0.1724137931034483, 'eval_f1': 0.17045454545454547, 'epoch': 3.2, 'total_flos': 280303804612608, 'step': 16}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.4541500434279442, 'eval_precision': 0.1509433962264151, 'eval_recall': 0.27586206896551724, 'eval_f1': 0.1951219512195122, 'epoch': 4.8, 'total_flos': 420455706918912, 'step': 24}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.30444332025945187, 'eval_precision': 0.3170731707317073, 'eval_recall': 0.4482758620689655, 'eval_f1': 0.37142857142857144, 'epoch': 6.4, 'total_flos': 560607609225216, 'step': 32}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1676230002194643, 'eval_precision': 0.5825242718446602, 'eval_recall': 0.6896551724137931, 'eval_f1': 0.631578947368421, 'epoch': 8.0, 'total_flos': 700759511531520, 'step': 40}62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.19771130895242095, 'eval_precision': 0.4727272727272727, 'eval_recall': 0.5977011494252874, 'eval_f1': 0.5279187817258884, 'epoch': 9.6, 'total_flos': 840911413837824, 'step': 48}it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.09it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.12380061682779342, 'eval_precision': 0.6836734693877551, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7243243243243244, 'epoch': 11.2, 'total_flos': 981063316144128, 'step': 56}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14375675306655467, 'eval_precision': 0.6213592233009708, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6736842105263158, 'epoch': 12.8, 'total_flos': 1121215218450432, 'step': 64}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.11101959785446525, 'eval_precision': 0.6213592233009708, 'eval_recall': 0.735632183908046, 'eval_f1': 0.6736842105263158, 'epoch': 14.4, 'total_flos': 1261367120756736, 'step': 72}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.17271380126476288, 'eval_precision': 0.71875, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7540983606557378, 'epoch': 16.0, 'total_flos': 1401519023063040, 'step': 80}00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.11884189583361149, 'eval_precision': 0.7291666666666666, 'eval_recall': 0.8045977011494253, 'eval_f1': 0.7650273224043717, 'epoch': 17.6, 'total_flos': 1541670925369344, 'step': 88}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.88it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.15464294829871505, 'eval_precision': 0.61, 'eval_recall': 0.7011494252873564, 'eval_f1': 0.6524064171122995, 'epoch': 19.2, 'total_flos': 1681822827675648, 'step': 96}00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.61it/s]
{'eval_loss': 0.19387905168696307, 'eval_precision': 0.6326530612244898, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6702702702702703, 'epoch': 20.8, 'total_flos': 1821974729981952, 'step': 104}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14563396649464266, 'eval_precision': 0.723404255319149, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7513812154696133, 'epoch': 22.4, 'total_flos': 1962126632288256, 'step': 112}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.15641122875967994, 'eval_precision': 0.6138613861386139, 'eval_recall': 0.7126436781609196, 'eval_f1': 0.6595744680851064, 'epoch': 24.0, 'total_flos': 2102278534594560, 'step': 120}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.11905775371633354, 'eval_precision': 0.7717391304347826, 'eval_recall': 0.8160919540229885, 'eval_f1': 0.7932960893854749, 'epoch': 25.6, 'total_flos': 2242430436900864, 'step': 128}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.64it/s]
{'eval_loss': 0.11789224052336067, 'eval_precision': 0.6979166666666666, 'eval_recall': 0.7701149425287356, 'eval_f1': 0.7322404371584699, 'epoch': 27.2, 'total_flos': 2382582339207168, 'step': 136}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.11104156241344754, 'eval_precision': 0.7666666666666667, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7796610169491527, 'epoch': 28.8, 'total_flos': 2522734241513472, 'step': 144}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.10781042656162754, 'eval_precision': 0.7835051546391752, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8260869565217391, 'epoch': 30.4, 'total_flos': 2662886143819776, 'step': 152}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.08912705076727434, 'eval_precision': 0.8, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8351648351648352, 'epoch': 32.0, 'total_flos': 2803038046126080, 'step': 160}00:00,  9.61it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1451077972742496, 'eval_precision': 0.75, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.770949720670391, 'epoch': 33.6, 'total_flos': 2943189948432384, 'step': 168}<00:00,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.10it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.35885914178834355, 'eval_precision': 0.7078651685393258, 'eval_recall': 0.7241379310344828, 'eval_f1': 0.7159090909090908, 'epoch': 35.2, 'total_flos': 3083341850738688, 'step': 176}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.11018918416812085, 'eval_precision': 0.8837209302325582, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8786127167630059, 'epoch': 36.8, 'total_flos': 3223493753044992, 'step': 184}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1164783481071936, 'eval_precision': 0.9047619047619048, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8888888888888888, 'epoch': 38.4, 'total_flos': 3363645655351296, 'step': 192}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.09806970768113388, 'eval_precision': 0.9186046511627907, 'eval_recall': 0.9080459770114943, 'eval_f1': 0.9132947976878613, 'epoch': 40.0, 'total_flos': 3503797557657600, 'step': 200}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.10393987043789821, 'eval_precision': 0.8850574712643678, 'eval_recall': 0.8850574712643678, 'eval_f1': 0.8850574712643678, 'epoch': 41.6, 'total_flos': 3643949459963904, 'step': 208}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.1182176130823791, 'eval_precision': 0.8636363636363636, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8685714285714287, 'epoch': 43.2, 'total_flos': 3784101362270208, 'step': 216}/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.11903560673817992, 'eval_precision': 0.8444444444444444, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8587570621468928, 'epoch': 44.8, 'total_flos': 3924253264576512, 'step': 224}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.12727238667139318, 'eval_precision': 0.8222222222222222, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8361581920903955, 'epoch': 46.4, 'total_flos': 4064405166882816, 'step': 232}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.12931145439870306, 'eval_precision': 0.8735632183908046, 'eval_recall': 0.8735632183908046, 'eval_f1': 0.8735632183908046, 'epoch': 48.0, 'total_flos': 4204557069189120, 'step': 240}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.12327373487642035, 'eval_precision': 0.8222222222222222, 'eval_recall': 0.8505747126436781, 'eval_f1': 0.8361581920903955, 'epoch': 49.6, 'total_flos': 4344708971495424, 'step': 248}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.13556913431966677, 'eval_precision': 0.71875, 'eval_recall': 0.7931034482758621, 'eval_f1': 0.7540983606557378, 'epoch': 51.2, 'total_flos': 4484860873801728, 'step': 256}0,  9.62it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.14437083632219583, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 52.8, 'total_flos': 4625012776108032, 'step': 264}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.13967131811659783, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 54.4, 'total_flos': 4765164678414336, 'step': 272}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.62it/s]
{'eval_loss': 0.13587893769727089, 'eval_precision': 0.7010309278350515, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7391304347826086, 'epoch': 56.0, 'total_flos': 4905316580720640, 'step': 280}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.89it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.133827142912196, 'eval_precision': 0.7010309278350515, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7391304347826086, 'epoch': 57.6, 'total_flos': 5045468483026944, 'step': 288}t/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:12<00:00,  3.11it/s]
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.63it/s]
{'eval_loss': 0.13804331500432454, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 59.2, 'total_flos': 5185620385333248, 'step': 296}s]
Iteration: 100%|████████████████████████████████████████████████████| 40/40 [00:13<00:00,  2.90it/s]
Epoch: 100%|████████████████████████████████████████████████████████| 60/60 [13:28<00:00, 13.48s/it]
/home/yoonsik/anaconda3/envs/ml/lib/python3.8/site-packages/transformers/trainer.py:1175: FutureWarning: This method is deprecated, use `Trainer.is_world_process_zero()` instead.
  warnings.warn("This method is deprecated, use `Trainer.is_world_process_zero()` instead.", FutureWarning)
04/18/2021 07:51:27 - INFO - __main__ -   *** Evaluate ***
Evaluation: 100%|█████████████████████████████████████████████████████| 8/8 [00:00<00:00,  9.73it/s]
{'eval_loss': 0.13827609436702915, 'eval_precision': 0.7083333333333334, 'eval_recall': 0.7816091954022989, 'eval_f1': 0.7431693989071038, 'epoch': 60.0, 'total_flos': 5255696336486400, 'step': 300}
04/18/2021 07:51:28 - INFO - __main__ -   ***** Eval results *****
04/18/2021 07:51:28 - INFO - __main__ -     eval_loss = 0.13827609436702915
04/18/2021 07:51:28 - INFO - __main__ -     eval_precision = 0.7083333333333334
04/18/2021 07:51:28 - INFO - __main__ -     eval_recall = 0.7816091954022989
04/18/2021 07:51:28 - INFO - __main__ -     eval_f1 = 0.7431693989071038
04/18/2021 07:51:28 - INFO - __main__ -     epoch = 60.0
04/18/2021 07:51:28 - INFO - __main__ -     total_flos = 5255696336486400
